import{_ as d}from"./app-BX_EKoAH.js";import{p as i}from"./wavesurfer-manager-AxFnsDT5.js";import"./wavesurfer.esm-Toh_7rjd.js";function p({audioUrl:s="",useVoiceNoteManager:n=!1,size:o="md",containerRef:l="waveformContainer",instanceKey:h=null}={}){return{audioUrl:s,useVoiceNoteManager:n,size:o,containerRef:l,instanceKey:h,isLoaded:!1,isPlaying:!1,currentTime:0,duration:0,updateInterval:null,init(){this.useVoiceNoteManager&&this.startTimeUpdates()},onWavesurferReady(e){this.isLoaded=!0,this.duration=e.getDuration()},async togglePlay(){if(this.useVoiceNoteManager){const e=this.$refs[this.containerRef];if(!e){console.error("Waveform container not found");return}const a={sm:{height:24,barWidth:1.5,barGap:.5},md:{height:32,barWidth:2,barGap:1},lg:{height:40,barWidth:3,barGap:1.5}},t=a[this.size]||a.md,r=document.documentElement.classList.contains("dark"),u={height:t.height,waveColor:r?"#52525b":"#e4e4e7",progressColor:"#0ea5e9",cursorColor:r?"#0284c7":"#0369a1",barWidth:t.barWidth,barGap:t.barGap,responsive:!0,normalize:!0,backend:"WebAudio"};await i.togglePlay(this.instanceKey,e,this.audioUrl,this.onWavesurferReady.bind(this),u)}else this.wavesurfer?this.wavesurfer.playPause():d(()=>import("./wavesurfer.esm-Toh_7rjd.js"),[]).then(e=>{this.wavesurfer=e.default.create({container:this.$refs[this.containerRef]}),this.wavesurfer.load(this.audioUrl),this.wavesurfer.on("ready",()=>this.wavesurfer.play())})},startTimeUpdates(){this.updateInterval&&clearInterval(this.updateInterval),this.updateInterval=setInterval(()=>{this.useVoiceNoteManager&&i.getActiveInstanceKey()===this.instanceKey?(this.currentTime=i.getCurrentTime(),this.isPlaying=i.isPlaying()):this.isPlaying=!1},100)},formatTime(e){if(!isFinite(e)||e<0)return"0:00";const a=Math.floor(e/60),t=Math.floor(e%60);return`${a}:${t.toString().padStart(2,"0")}`},showError(){const e=this.$refs[this.containerRef];e&&(e.innerHTML=`
                    <div class="flex items-center justify-center h-full text-red-500 text-xs">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        Failed to load audio
                    </div>
                `)},cleanup(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.useVoiceNoteManager&&i.destroy(this.instanceKey)}}}export{p as default};
