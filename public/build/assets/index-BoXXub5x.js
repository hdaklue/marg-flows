import{c as re,g as We}from"./app-Dt-WG-si.js";import{r as Ze,v as ke}from"./video.es-D_xdPcRz.js";var _e={exports:{}},Ve;function Ye(){return Ve||(Ve=1,function(Te){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function F(o,e){if(!o)throw"First parameter is required.";e=e||{type:"video"},e=new ge(o,e);var a=this;function w(p){return e.disableLogs||console.log("RecordRTC version: ",a.version),p&&(e=new ge(o,p)),e.disableLogs||console.log("started recording "+e.type+" stream."),E?(E.clearRecordedData(),E.record(),d("recording"),a.recordingDuration&&s(),a):(C(function(){a.recordingDuration&&s()}),a)}function C(p){p&&(e.initCallback=function(){p(),p=e.initCallback=null});var L=new ye(o,e);E=new L(o,e),E.record(),d("recording"),e.disableLogs||console.log("Initialized recorderType:",E.constructor.name,"for output-type:",e.type)}function y(p){if(p=p||function(){},!E){R();return}if(a.state==="paused"){a.resumeRecording(),setTimeout(function(){y(p)},1);return}a.state!=="recording"&&!e.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',a.state),e.disableLogs||console.log("Stopped recording "+e.type+" stream."),e.type!=="gif"?E.stop(L):(E.stop(),L()),d("stopped");function L(x){if(!E){typeof p.call=="function"?p.call(a,""):p("");return}Object.keys(E).forEach(function(V){typeof E[V]!="function"&&(a[V]=E[V])});var h=E.blob;if(!h)if(x)E.blob=h=x;else throw"Recording failed.";if(h&&!e.disableLogs&&console.log(h.type,"->",S(h.size)),p){var j;try{j=n.createObjectURL(h)}catch{}typeof p.call=="function"?p.call(a,j):p(j)}e.autoWriteToDisk&&i(function(V){var z={};z[e.type+"Blob"]=V,$.Store(z)})}}function u(){if(!E){R();return}if(a.state!=="recording"){e.disableLogs||console.warn("Unable to pause the recording. Recording state: ",a.state);return}d("paused"),E.pause(),e.disableLogs||console.log("Paused recording.")}function t(){if(!E){R();return}if(a.state!=="paused"){e.disableLogs||console.warn("Unable to resume the recording. Recording state: ",a.state);return}d("recording"),E.resume(),e.disableLogs||console.log("Resumed recording.")}function f(p){postMessage(new FileReaderSync().readAsDataURL(p))}function i(p,L){if(!p)throw"Pass a callback function over getDataURL.";var x=L?L.blob:(E||{}).blob;if(!x){e.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){i(p,L)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var h=V(f);h.onmessage=function(z){p(z.data)},h.postMessage(x)}else{var j=new FileReader;j.readAsDataURL(x),j.onload=function(z){p(z.target.result)}}function V(z){try{var q=n.createObjectURL(new Blob([z.toString(),"this.onmessage =  function (eee) {"+z.name+"(eee.data);}"],{type:"application/javascript"})),Z=new Worker(q);return n.revokeObjectURL(q),Z}catch{}}}function s(p){if(p=p||0,a.state==="paused"){setTimeout(function(){s(p)},1e3);return}if(a.state!=="stopped"){if(p>=a.recordingDuration){y(a.onRecordingStopped);return}p+=1e3,setTimeout(function(){s(p)},1e3)}}function d(p){a&&(a.state=p,typeof a.onStateChanged.call=="function"?a.onStateChanged.call(a,p):a.onStateChanged(p))}var g='It seems that recorder is destroyed or "startRecording" is not invoked for '+e.type+" recorder.";function R(){e.disableLogs!==!0&&console.warn(g)}var E,P={startRecording:w,stopRecording:y,pauseRecording:u,resumeRecording:t,initRecorder:C,setRecordingDuration:function(p,L){if(typeof p>"u")throw"recordingDuration is required.";if(typeof p!="number")throw"recordingDuration must be a number.";return a.recordingDuration=p,a.onRecordingStopped=L||function(){},{onRecordingStopped:function(x){a.onRecordingStopped=x}}},clearRecordedData:function(){if(!E){R();return}E.clearRecordedData(),e.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!E){R();return}return E.blob},getDataURL:i,toURL:function(){if(!E){R();return}return n.createObjectURL(E.blob)},getInternalRecorder:function(){return E},save:function(p){if(!E){R();return}I(E.blob,p)},getFromDisk:function(p){if(!E){R();return}F.getFromDisk(e.type,p)},setAdvertisementArray:function(p){e.advertisement=[];for(var L=p.length,x=0;x<L;x++)e.advertisement.push({duration:x,image:p[x]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){a.state==="recording"&&!e.disableLogs&&console.warn("Stop an active recorder."),E&&typeof E.clearRecordedData=="function"&&E.clearRecordedData(),E=null,d("inactive"),a.blob=null},onStateChanged:function(p){e.disableLogs||console.log("Recorder state changed:",p)},state:"inactive",getState:function(){return a.state},destroy:function(){var p=e.disableLogs;e={disableLogs:!0},a.reset(),d("destroyed"),P=a=null,Y.AudioContextConstructor&&(Y.AudioContextConstructor.close(),Y.AudioContextConstructor=null),e.disableLogs=p,e.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return a=P,P;for(var W in P)this[W]=P[W];return a=this,P}F.version="5.6.2",Te.exports=F,F.getFromDisk=function(o,e){if(!e)throw"callback is mandatory.";console.log("Getting recorded "+(o==="all"?"blobs":o+" blob ")+" from disk!"),$.Fetch(function(a,w){o!=="all"&&w===o+"Blob"&&e&&e(a),o==="all"&&e&&e(a,w.replace("Blob",""))})},F.writeToDisk=function(o){console.log("Writing recorded blob(s) to disk!"),o=o||{},o.audio&&o.video&&o.gif?o.audio.getDataURL(function(e){o.video.getDataURL(function(a){o.gif.getDataURL(function(w){$.Store({audioBlob:e,videoBlob:a,gifBlob:w})})})}):o.audio&&o.video?o.audio.getDataURL(function(e){o.video.getDataURL(function(a){$.Store({audioBlob:e,videoBlob:a})})}):o.audio&&o.gif?o.audio.getDataURL(function(e){o.gif.getDataURL(function(a){$.Store({audioBlob:e,gifBlob:a})})}):o.video&&o.gif?o.video.getDataURL(function(e){o.gif.getDataURL(function(a){$.Store({videoBlob:e,gifBlob:a})})}):o.audio?o.audio.getDataURL(function(e){$.Store({audioBlob:e})}):o.video?o.video.getDataURL(function(e){$.Store({videoBlob:e})}):o.gif&&o.gif.getDataURL(function(e){$.Store({gifBlob:e})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function ge(o,e){return!e.recorderType&&!e.type&&(e.audio&&e.video?e.type="video":e.audio&&!e.video&&(e.type="audio")),e.recorderType&&!e.type&&(e.recorderType===G||e.recorderType===U||typeof Q<"u"&&e.recorderType===Q?e.type="video":e.recorderType===ee?e.type="gif":e.recorderType===M?e.type="audio":e.recorderType===m&&(_(o,"audio").length&&_(o,"video").length||!_(o,"audio").length&&_(o,"video").length?e.type="video":_(o,"audio").length&&!_(o,"video").length&&(e.type="audio"))),typeof m<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(e.mimeType||(e.mimeType="video/webm"),e.type||(e.type=e.mimeType.split("/")[0]),e.bitsPerSecond),e.type||(e.mimeType&&(e.type=e.mimeType.split("/")[0]),e.type||(e.type="audio")),e}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function ye(o,e){var a;return(v||c||O)&&(a=M),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!v&&(a=m),e.type==="video"&&(v||O)&&(a=G,typeof Q<"u"&&typeof ReadableStream<"u"&&(a=Q)),e.type==="gif"&&(a=ee),e.type==="canvas"&&(a=U),k()&&a!==U&&a!==ee&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(_(o,"video").length||_(o,"audio").length)&&(e.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(a=m):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(a=m)),o instanceof Array&&o.length&&(a=A),e.recorderType&&(a=e.recorderType),!e.disableLogs&&a&&a.name&&console.log("Using recorderType:",a.name||a.constructor.name),!a&&T&&(a=m),a}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function he(o){this.addStream=function(e){e&&(o=e)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var e=this.mediaType,a,w=this.mimeType||{audio:null,video:null,gif:null};if(typeof e.audio!="function"&&k()&&!_(o,"audio").length&&(e.audio=!1),typeof e.video!="function"&&k()&&!_(o,"video").length&&(e.video=!1),typeof e.gif!="function"&&k()&&!_(o,"video").length&&(e.gif=!1),!e.audio&&!e.video&&!e.gif)throw"MediaStream must have either audio or video tracks.";if(e.audio&&(a=null,typeof e.audio=="function"&&(a=e.audio),this.audioRecorder=new F(o,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:a,mimeType:w.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),e.video||this.audioRecorder.startRecording()),e.video){a=null,typeof e.video=="function"&&(a=e.video);var C=o;if(k()&&e.audio&&typeof e.audio=="function"){var y=_(o,"video")[0];D?(C=new b,C.addTrack(y),a&&a===G&&(a=m)):(C=new b,C.addTrack(y))}this.videoRecorder=new F(C,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:a,mimeType:w.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),e.audio||this.videoRecorder.startRecording()}if(e.audio&&e.video){var u=this,t=k()===!0;(e.audio instanceof M&&e.video||e.audio!==!0&&e.video!==!0&&e.audio!==e.video)&&(t=!1),t===!0?(u.audioRecorder=null,u.videoRecorder.startRecording()):u.videoRecorder.initRecorder(function(){u.audioRecorder.initRecorder(function(){u.videoRecorder.startRecording(),u.audioRecorder.startRecording()})})}e.gif&&(a=null,typeof e.gif=="function"&&(a=e.gif),this.gifRecorder=new F(o,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:a,mimeType:w.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(a){e(a,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(a){e(a,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(a){e(a,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var a={};return this.audioRecorder&&(a.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(a.video=this.videoRecorder.getBlob()),this.gifRecorder&&(a.gif=this.gifRecorder.getBlob()),e&&e(a),a},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){this.getBlob(function(C){C.audio&&C.video?a(C.audio,function(y){a(C.video,function(u){e({audio:y,video:u})})}):C.audio?a(C.audio,function(y){e({audio:y})}):C.video&&a(C.video,function(y){e({video:y})})});function a(C,y){if(typeof Worker<"u"){var u=w(function(i){postMessage(new FileReaderSync().readAsDataURL(i))});u.onmessage=function(f){y(f.data)},u.postMessage(C)}else{var t=new FileReader;t.readAsDataURL(C),t.onload=function(f){y(f.target.result)}}}function w(C){var y=n.createObjectURL(new Blob([C.toString(),"this.onmessage =  function (eee) {"+C.name+"(eee.data);}"],{type:"application/javascript"})),u=new Worker(y),t;if(typeof n<"u")t=n;else if(typeof webkitURL<"u")t=webkitURL;else throw"Neither URL nor webkitURL detected.";return t.revokeObjectURL(y),u}},this.writeToDisk=function(){F.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save(typeof e.audio=="string"?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save(typeof e.video=="string"?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save(typeof e.gif=="string"?e.gif:"")}}he.getFromDisk=F.getFromDisk,he.writeToDisk=F.writeToDisk,typeof F<"u"&&(F.MRecordRTC=he);var De="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(o){o&&(typeof window<"u"||typeof re>"u"||(re.navigator={userAgent:De,getUserMedia:function(){}},re.console||(re.console={}),(typeof re.console.log>"u"||typeof re.console.error>"u")&&(re.console.error=re.console.log=re.console.log||function(){console.log(arguments)}),typeof document>"u"&&(o.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},o.HTMLVideoElement=function(){}),typeof location>"u"&&(o.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(o.screen={width:0,height:0}),typeof n>"u"&&(o.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),o.window=re))})(typeof re<"u"?re:null);var K=window.requestAnimationFrame;if(typeof K>"u"){if(typeof webkitRequestAnimationFrame<"u")K=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")K=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")K=msRequestAnimationFrame;else if(typeof K>"u"){var Oe=0;K=function(o,e){var a=new Date().getTime(),w=Math.max(0,16-(a-Oe)),C=setTimeout(function(){o(a+w)},w);return Oe=a+w,C}}}var l=window.cancelAnimationFrame;typeof l>"u"&&(typeof webkitCancelAnimationFrame<"u"?l=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?l=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?l=msCancelAnimationFrame:typeof l>"u"&&(l=function(o){clearTimeout(o)}));var r=window.AudioContext;typeof r>"u"&&(typeof webkitAudioContext<"u"&&(r=webkitAudioContext),typeof mozAudioContext<"u"&&(r=mozAudioContext));var n=window.URL;typeof n>"u"&&typeof webkitURL<"u"&&(n=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var c=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),O=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,D=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),v=!O&&!c&&!!navigator.webkitGetUserMedia||B()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,T=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);T&&!v&&navigator.userAgent.indexOf("CriOS")!==-1&&(T=!1,v=!0);var b=window.MediaStream;typeof b>"u"&&typeof webkitMediaStream<"u"&&(b=webkitMediaStream),typeof b<"u"&&typeof b.prototype.stop>"u"&&(b.prototype.stop=function(){this.getTracks().forEach(function(o){o.stop()})});function S(o){var e=1e3,a=["Bytes","KB","MB","GB","TB"];if(o===0)return"0 Bytes";var w=parseInt(Math.floor(Math.log(o)/Math.log(e)),10);return(o/Math.pow(e,w)).toPrecision(3)+" "+a[w]}function I(o,e){if(!o)throw"Blob object is required.";if(!o.type)try{o.type="video/webm"}catch{}var a=(o.type||"video/webm").split("/")[1];if(a.indexOf(";")!==-1&&(a=a.split(";")[0]),e&&e.indexOf(".")!==-1){var w=e.split(".");e=w[0],a=w[1]}var C=(e||Math.round(Math.random()*9999999999)+888888888)+"."+a;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(o,C);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(o,C);var y=document.createElement("a");y.href=n.createObjectURL(o),y.download=C,y.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(y),typeof y.click=="function"?y.click():(y.target="_blank",y.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),n.revokeObjectURL(y.href)}function B(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}function _(o,e){return!o||!o.getTracks?[]:o.getTracks().filter(function(a){return a.kind===(e||"audio")})}function J(o,e){"srcObject"in e?e.srcObject=o:"mozSrcObject"in e?e.mozSrcObject=o:e.srcObject=o}function H(o,e){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var a=new EBML.Reader,w=new EBML.Decoder,C=EBML.tools,y=new FileReader;y.onload=function(u){var t=w.decode(this.result);t.forEach(function(d){a.read(d)}),a.stop();var f=C.makeMetadataSeekable(a.metadatas,a.duration,a.cues),i=this.result.slice(a.metadataSize),s=new Blob([f,i],{type:"video/webm"});e(s)},y.readAsArrayBuffer(o)}typeof F<"u"&&(F.invokeSaveAsDialog=I,F.getTracks=_,F.getSeekableBlob=H,F.bytesToSize=S,F.isElectron=B);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var Y={};typeof r<"u"?Y.AudioContext=r:typeof webkitAudioContext<"u"&&(Y.AudioContext=webkitAudioContext),typeof F<"u"&&(F.Storage=Y);function k(){if(D||T||c)return!0;var o=navigator.userAgent,e=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10),w,C;return(v||O)&&(w=o.indexOf("Chrome"),e=o.substring(w+7)),(C=e.indexOf(";"))!==-1&&(e=e.substring(0,C)),(C=e.indexOf(" "))!==-1&&(e=e.substring(0,C)),a=parseInt(""+e,10),isNaN(a)&&(e=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10)),a>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function m(o,e){var s=this;if(typeof o>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(e=e||{mimeType:"video/webm"},e.type==="audio"){if(_(o,"video").length&&_(o,"audio").length){var a;navigator.mozGetUserMedia?(a=new b,a.addTrack(_(o,"audio")[0])):a=new b(_(o,"audio")),o=a}(!e.mimeType||e.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(e.mimeType=v?"audio/webm":"audio/ogg"),e.mimeType&&e.mimeType.toString().toLowerCase()!=="audio/ogg"&&navigator.mozGetUserMedia&&(e.mimeType="audio/ogg")}var w=[];this.getArrayOfBlobs=function(){return w},this.record=function(){s.blob=null,s.clearRecordedData(),s.timestamps=[],i=[],w=[];var d=e;e.disableLogs||console.log("Passing following config over MediaRecorder API.",d),t&&(t=null),v&&!k()&&(d="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&d.mimeType&&(MediaRecorder.isTypeSupported(d.mimeType)||(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",d.mimeType),d.mimeType=e.type==="audio"?"audio/webm":"video/webm"));try{t=new MediaRecorder(o,d),e.mimeType=d.mimeType}catch{t=new MediaRecorder(o)}d.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in t&&t.canRecordMimeType(d.mimeType)===!1&&(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",d.mimeType)),t.ondataavailable=function(g){if(g.data&&i.push("ondataavailable: "+S(g.data.size)),typeof e.timeSlice=="number"){if(g.data&&g.data.size&&(w.push(g.data),C(),typeof e.ondataavailable=="function")){var R=e.getNativeBlob?g.data:new Blob([g.data],{type:y(d)});e.ondataavailable(R)}return}if(!g.data||!g.data.size||g.data.size<100||s.blob){s.recordingCallback&&(s.recordingCallback(new Blob([],{type:y(d)})),s.recordingCallback=null);return}s.blob=e.getNativeBlob?g.data:new Blob([g.data],{type:y(d)}),s.recordingCallback&&(s.recordingCallback(s.blob),s.recordingCallback=null)},t.onstart=function(){i.push("started")},t.onpause=function(){i.push("paused")},t.onresume=function(){i.push("resumed")},t.onstop=function(){i.push("stopped")},t.onerror=function(g){g&&(g.name||(g.name="UnknownError"),i.push("error: "+g),e.disableLogs||(g.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",g):g.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",d.mimeType,") is not supported.",g):g.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",g):g.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",g):g.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",g):g.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",g):g.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",g):console.error("MediaRecorder Error",g)),function(R){if(!s.manuallyStopped&&t&&t.state==="inactive"){delete e.timeslice,t.start(10*60*1e3);return}setTimeout(R,1e3)}(),t.state!=="inactive"&&t.state!=="stopped"&&t.stop())},typeof e.timeSlice=="number"?(C(),t.start(e.timeSlice)):t.start(36e5),e.initCallback&&e.initCallback()},this.timestamps=[];function C(){s.timestamps.push(new Date().getTime()),typeof e.onTimeStamp=="function"&&e.onTimeStamp(s.timestamps[s.timestamps.length-1],s.timestamps)}function y(d){return t&&t.mimeType?t.mimeType:d.mimeType||"video/webm"}this.stop=function(d){d=d||function(){},s.manuallyStopped=!0,t&&(this.recordingCallback=d,t.state==="recording"&&t.stop(),typeof e.timeSlice=="number"&&setTimeout(function(){s.blob=new Blob(w,{type:y(e)}),s.recordingCallback(s.blob)},100))},this.pause=function(){t&&t.state==="recording"&&t.pause()},this.resume=function(){t&&t.state==="paused"&&t.resume()},this.clearRecordedData=function(){t&&t.state==="recording"&&s.stop(u),u()};function u(){w=[],t=null,s.timestamps=[]}var t;this.getInternalRecorder=function(){return t};function f(){if("active"in o){if(!o.active)return!1}else if("ended"in o&&o.ended)return!1;return!0}this.blob=null,this.getState=function(){return t&&t.state||"inactive"};var i=[];this.getAllStates=function(){return i},typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!1);var s=this;(function d(){if(!(!t||e.checkForInactiveTracks===!1)){if(f()===!1){e.disableLogs||console.log("MediaStream seems stopped."),s.stop();return}setTimeout(d,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof F<"u"&&(F.MediaStreamRecorder=m);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function M(o,e){if(!_(o,"audio").length)throw"Your stream has no audio tracks.";e=e||{};var a=this,w=[],C=[],y=!1,u=0,t,f=2,i=e.desiredSampRate;e.leftChannel===!0&&(f=1),e.numberOfAudioChannels===1&&(f=1),(!f||f<1)&&(f=2),e.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+f),typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!0);function s(){if(e.checkForInactiveTracks===!1)return!0;if("active"in o){if(!o.active)return!1}else if("ended"in o&&o.ended)return!1;return!0}this.record=function(){if(s()===!1)throw"Please make sure MediaStream is active.";x(),j=L=!1,y=!0,typeof e.timeSlice<"u"&&q()};function d(Z,oe){function ae(ie,Se){var pe=ie.numberOfAudioChannels,de=ie.leftBuffers.slice(0),Re=ie.rightBuffers.slice(0),le=ie.sampleRate,Ee=ie.internalInterleavedLength,ve=ie.desiredSampRate;pe===2&&(de=Me(de,Ee),Re=Me(Re,Ee),ve&&(de=Ae(de,ve,le),Re=Ae(Re,ve,le))),pe===1&&(de=Me(de,Ee),ve&&(de=Ae(de,ve,le))),ve&&(le=ve);function Ae(ne,me,ce){var fe=Math.round(ne.length*(me/ce)),ue=[],Ce=Number((ne.length-1)/(fe-1));ue[0]=ne[0];for(var we=1;we<fe-1;we++){var Be=we*Ce,Fe=Number(Math.floor(Be)).toFixed(),Qe=Number(Math.ceil(Be)).toFixed(),Xe=Be-Fe;ue[we]=ze(ne[Fe],ne[Qe],Xe)}return ue[fe-1]=ne[ne.length-1],ue}function ze(ne,me,ce){return ne+(me-ne)*ce}function Me(ne,me){for(var ce=new Float64Array(me),fe=0,ue=ne.length,Ce=0;Ce<ue;Ce++){var we=ne[Ce];ce.set(we,fe),fe+=we.length}return ce}function He(ne,me){for(var ce=ne.length+me.length,fe=new Float64Array(ce),ue=0,Ce=0;Ce<ce;)fe[Ce++]=ne[ue],fe[Ce++]=me[ue],ue++;return fe}function je(ne,me,ce){for(var fe=ce.length,ue=0;ue<fe;ue++)ne.setUint8(me+ue,ce.charCodeAt(ue))}var Le;pe===2&&(Le=He(de,Re)),pe===1&&(Le=de);var Ie=Le.length,Je=44+Ie*2,Pe=new ArrayBuffer(Je),se=new DataView(Pe);je(se,0,"RIFF"),se.setUint32(4,36+Ie*2,!0),je(se,8,"WAVE"),je(se,12,"fmt "),se.setUint32(16,16,!0),se.setUint16(20,1,!0),se.setUint16(22,pe,!0),se.setUint32(24,le,!0),se.setUint32(28,le*pe*2,!0),se.setUint16(32,pe*2,!0),se.setUint16(34,16,!0),je(se,36,"data"),se.setUint32(40,Ie*2,!0);for(var Ke=Ie,xe=44,$e=1,Ue=0;Ue<Ke;Ue++)se.setInt16(xe,Le[Ue]*(32767*$e),!0),xe+=2;if(Se)return Se({buffer:Pe,view:se});postMessage({buffer:Pe,view:se})}if(Z.noWorker){ae(Z,function(ie){oe(ie.buffer,ie.view)});return}var be=g(ae);be.onmessage=function(ie){oe(ie.data.buffer,ie.data.view),n.revokeObjectURL(be.workerURL),be.terminate()},be.postMessage(Z)}function g(Z){var oe=n.createObjectURL(new Blob([Z.toString(),";this.onmessage =  function (eee) {"+Z.name+"(eee.data);}"],{type:"application/javascript"})),ae=new Worker(oe);return ae.workerURL=oe,ae}this.stop=function(Z){Z=Z||function(){},y=!1,d({desiredSampRate:i,sampleRate:p,numberOfAudioChannels:f,internalInterleavedLength:u,leftBuffers:w,rightBuffers:f===1?[]:C,noWorker:e.noWorker},function(oe,ae){a.blob=new Blob([ae],{type:"audio/wav"}),a.buffer=new ArrayBuffer(ae.buffer.byteLength),a.view=ae,a.sampleRate=i||p,a.bufferSize=W,a.length=u,j=!1,Z&&Z(a.blob)})},typeof F.Storage>"u"&&(F.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!F.Storage.AudioContextConstructor||F.Storage.AudioContextConstructor.state==="closed")&&(F.Storage.AudioContextConstructor=new F.Storage.AudioContext);var R=F.Storage.AudioContextConstructor,E=R.createMediaStreamSource(o),P=[0,256,512,1024,2048,4096,8192,16384],W=typeof e.bufferSize>"u"?4096:e.bufferSize;if(P.indexOf(W)===-1&&(e.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(P,null,"	"))),R.createJavaScriptNode)t=R.createJavaScriptNode(W,f,f);else if(R.createScriptProcessor)t=R.createScriptProcessor(W,f,f);else throw"WebAudio API has no support on this browser.";E.connect(t),e.bufferSize||(W=t.bufferSize);var p=typeof e.sampleRate<"u"?e.sampleRate:R.sampleRate||44100;(p<22050||p>96e3)&&(e.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),e.disableLogs||e.desiredSampRate&&console.log("Desired sample-rate: "+e.desiredSampRate);var L=!1;this.pause=function(){L=!0},this.resume=function(){if(s()===!1)throw"Please make sure MediaStream is active.";if(!y){e.disableLogs||console.log("Seems recording has been restarted."),this.record();return}L=!1},this.clearRecordedData=function(){e.checkForInactiveTracks=!1,y&&this.stop(h),h()};function x(){w=[],C=[],u=0,j=!1,y=!1,L=!1,R=null,a.leftchannel=w,a.rightchannel=C,a.numberOfAudioChannels=f,a.desiredSampRate=i,a.sampleRate=p,a.recordingLength=u,z={left:[],right:[],recordingLength:0}}function h(){t&&(t.onaudioprocess=null,t.disconnect(),t=null),E&&(E.disconnect(),E=null),x()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var j=!1;function V(Z){if(!L){if(s()===!1&&(e.disableLogs||console.log("MediaStream seems stopped."),t.disconnect(),y=!1),!y){E&&(E.disconnect(),E=null);return}j||(j=!0,e.onAudioProcessStarted&&e.onAudioProcessStarted(),e.initCallback&&e.initCallback());var oe=Z.inputBuffer.getChannelData(0),ae=new Float32Array(oe);if(w.push(ae),f===2){var be=Z.inputBuffer.getChannelData(1),ie=new Float32Array(be);C.push(ie)}u+=W,a.recordingLength=u,typeof e.timeSlice<"u"&&(z.recordingLength+=W,z.left.push(ae),f===2&&z.right.push(ie))}}t.onaudioprocess=V,R.createMediaStreamDestination?t.connect(R.createMediaStreamDestination()):t.connect(R.destination),this.leftchannel=w,this.rightchannel=C,this.numberOfAudioChannels=f,this.desiredSampRate=i,this.sampleRate=p,a.recordingLength=u;var z={left:[],right:[],recordingLength:0};function q(){!y||typeof e.ondataavailable!="function"||typeof e.timeSlice>"u"||(z.left.length?(d({desiredSampRate:i,sampleRate:p,numberOfAudioChannels:f,internalInterleavedLength:z.recordingLength,leftBuffers:z.left,rightBuffers:f===1?[]:z.right},function(Z,oe){var ae=new Blob([oe],{type:"audio/wav"});e.ondataavailable(ae),setTimeout(q,e.timeSlice)}),z={left:[],right:[],recordingLength:0}):setTimeout(q,e.timeSlice))}}typeof F<"u"&&(F.StereoAudioRecorder=M);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function U(o,e){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";e=e||{},e.frameInterval||(e.frameInterval=10);var a=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(P){P in document.createElement("canvas")&&(a=!0)});var w=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,C=50,y=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);w&&y&&y[2]&&(C=parseInt(y[2],10)),w&&C<52&&(a=!1),e.useWhammyRecorder&&(a=!1);var u,t;if(a)if(e.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),o instanceof HTMLCanvasElement)u=o;else if(o instanceof CanvasRenderingContext2D)u=o.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(e.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var f;this.record=function(){if(f=!0,a&&!e.useWhammyRecorder){var P;"captureStream"in u?P=u.captureStream(25):"mozCaptureStream"in u?P=u.mozCaptureStream(25):"webkitCaptureStream"in u&&(P=u.webkitCaptureStream(25));try{var W=new b;W.addTrack(_(P,"video")[0]),P=W}catch{}if(!P)throw"captureStream API are NOT available.";t=new m(P,{mimeType:e.mimeType||"video/webm"}),t.record()}else E.frames=[],R=new Date().getTime(),g();e.initCallback&&e.initCallback()},this.getWebPImages=function(P){if(o.nodeName.toLowerCase()!=="canvas"){P();return}var W=E.frames.length;E.frames.forEach(function(p,L){var x=W-L;e.disableLogs||console.log(x+"/"+W+" frames remaining"),e.onEncodingCallback&&e.onEncodingCallback(x,W);var h=p.image.toDataURL("image/webp",1);E.frames[L].image=h}),e.disableLogs||console.log("Generating WebM"),P()},this.stop=function(P){f=!1;var W=this;if(a&&t){t.stop(P);return}this.getWebPImages(function(){E.compile(function(p){e.disableLogs||console.log("Recording finished!"),W.blob=p,W.blob.forEach&&(W.blob=new Blob([],{type:"video/webm"})),P&&P(W.blob),E.frames=[]})})};var i=!1;this.pause=function(){if(i=!0,t instanceof m){t.pause();return}},this.resume=function(){if(i=!1,t instanceof m){t.resume();return}f||this.record()},this.clearRecordedData=function(){f&&this.stop(s),s()};function s(){E.frames=[],f=!1,i=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function d(){var P=document.createElement("canvas"),W=P.getContext("2d");return P.width=o.width,P.height=o.height,W.drawImage(o,0,0),P}function g(){if(i)return R=new Date().getTime(),setTimeout(g,500);if(o.nodeName.toLowerCase()==="canvas"){var P=new Date().getTime()-R;R=new Date().getTime(),E.frames.push({image:d(),duration:P}),f&&setTimeout(g,e.frameInterval);return}html2canvas(o,{grabMouse:typeof e.showMousePointer>"u"||e.showMousePointer,onrendered:function(W){var p=new Date().getTime()-R;if(!p)return setTimeout(g,e.frameInterval);R=new Date().getTime(),E.frames.push({image:W.toDataURL("image/webp",1),duration:p}),f&&setTimeout(g,e.frameInterval)}})}var R=new Date().getTime(),E=new N.Video(100)}typeof F<"u"&&(F.CanvasRecorder=U);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function G(o,e){e=e||{},e.frameInterval||(e.frameInterval=10),e.disableLogs||console.log("Using frames-interval:",e.frameInterval),this.record=function(){e.width||(e.width=320),e.height||(e.height=240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),f.width=e.canvas.width||320,f.height=e.canvas.height||240,i=f.getContext("2d"),e.video&&e.video instanceof HTMLVideoElement?(s=e.video.cloneNode(),e.initCallback&&e.initCallback()):(s=document.createElement("video"),J(o,s),s.onloadedmetadata=function(){e.initCallback&&e.initCallback()},s.width=e.video.width,s.height=e.video.height),s.muted=!0,s.play(),d=new Date().getTime(),g=new N.Video,e.disableLogs||(console.log("canvas resolutions",f.width,"*",f.height),console.log("video width/height",s.width||f.width,"*",s.height||f.height)),a(e.frameInterval)};function a(R){R=typeof R<"u"?R:10;var E=new Date().getTime()-d;if(!E)return setTimeout(a,R,R);if(u)return d=new Date().getTime(),setTimeout(a,100);d=new Date().getTime(),s.paused&&s.play(),i.drawImage(s,0,0,f.width,f.height),g.frames.push({duration:E,image:f.toDataURL("image/webp")}),y||setTimeout(a,R,R)}function w(R){var E=-1,P=R.length;(function W(){if(E++,E===P){R.callback();return}setTimeout(function(){R.functionToLoop(W,E)},1)})()}function C(R,E,P,W,p){var L=document.createElement("canvas");L.width=f.width,L.height=f.height;var x=L.getContext("2d"),h=[],j=R.length,V={r:0,g:0,b:0},z=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),q=0,Z=0,oe=!1;w({length:j,functionToLoop:function(ae,be){var ie,Se,pe,de=function(){!oe&&pe-ie<=pe*Z||(oe=!0,h.push(R[be])),ae()};if(oe)de();else{var Re=new Image;Re.onload=function(){x.drawImage(Re,0,0,f.width,f.height);var le=x.getImageData(0,0,f.width,f.height);ie=0,Se=le.data.length,pe=le.data.length/4;for(var Ee=0;Ee<Se;Ee+=4){var ve={r:le.data[Ee],g:le.data[Ee+1],b:le.data[Ee+2]},Ae=Math.sqrt(Math.pow(ve.r-V.r,2)+Math.pow(ve.g-V.g,2)+Math.pow(ve.b-V.b,2));Ae<=z*q&&ie++}de()},Re.src=R[be].image}},callback:function(){h=h.concat(R.slice(j)),h.length<=0&&h.push(R[R.length-1]),p(h)}})}var y=!1;this.stop=function(R){R=R||function(){},y=!0;var E=this;setTimeout(function(){C(g.frames,-1,null,null,function(P){g.frames=P,e.advertisement&&e.advertisement.length&&(g.frames=e.advertisement.concat(g.frames)),g.compile(function(W){E.blob=W,E.blob.forEach&&(E.blob=new Blob([],{type:"video/webm"})),R&&R(E.blob)})})},10)};var u=!1;this.pause=function(){u=!0},this.resume=function(){u=!1,y&&this.record()},this.clearRecordedData=function(){y||this.stop(t),t()};function t(){g.frames=[],y=!0,u=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var f=document.createElement("canvas"),i=f.getContext("2d"),s,d,g}typeof F<"u"&&(F.WhammyRecorder=G);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var N=function(){function o(w){this.frames=[],this.duration=w||1,this.quality=.8}o.prototype.add=function(w,C){if("canvas"in w&&(w=w.canvas),"toDataURL"in w&&(w=w.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(w))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:w,duration:C||this.duration})};function e(w){var C=n.createObjectURL(new Blob([w.toString(),"this.onmessage =  function (eee) {"+w.name+"(eee.data);}"],{type:"application/javascript"})),y=new Worker(C);return n.revokeObjectURL(C),y}function a(w){function C(p){var L=u(p);if(!L)return[];for(var x=3e4,h=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:P(L.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:L.width,id:176},{data:L.height,id:186}]}]}]}]}],j=0,V=0;j<p.length;){var z=[],q=0;do z.push(p[j]),q+=p[j].duration,j++;while(j<p.length&&q<x);var Z=0,oe={id:524531317,data:y(V,Z,z)};h[1].data.push(oe),V+=q}return s(h)}function y(p,L,x){return[{data:p,id:231}].concat(x.map(function(h){var j=d({frame:h.data.slice(4),trackNum:1,timecode:Math.round(L)});return L+=h.duration,{data:j,id:163}}))}function u(p){if(!p[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var L=p[0].width,x=p[0].height,h=p[0].duration,j=1;j<p.length;j++)h+=p[j].duration;return{duration:h,width:L,height:x}}function t(p){for(var L=[];p>0;)L.push(p&255),p=p>>8;return new Uint8Array(L.reverse())}function f(p){return new Uint8Array(p.split("").map(function(L){return L.charCodeAt(0)}))}function i(p){var L=[],x=p.length%8?new Array(9-p.length%8).join("0"):"";p=x+p;for(var h=0;h<p.length;h+=8)L.push(parseInt(p.substr(h,8),2));return new Uint8Array(L)}function s(p){for(var L=[],x=0;x<p.length;x++){var h=p[x].data;typeof h=="object"&&(h=s(h)),typeof h=="number"&&(h=i(h.toString(2))),typeof h=="string"&&(h=f(h));var j=h.size||h.byteLength||h.length,V=Math.ceil(Math.ceil(Math.log(j)/Math.log(2))/8),z=j.toString(2),q=new Array(V*7+7+1-z.length).join("0")+z,Z=new Array(V).join("0")+"1"+q;L.push(t(p[x].id)),L.push(i(Z)),L.push(h)}return new Blob(L,{type:"video/webm"})}function d(p){var L=0;L|=128;var x=[p.trackNum|128,p.timecode>>8,p.timecode&255,L].map(function(h){return String.fromCharCode(h)}).join("")+p.frame;return x}function g(p){for(var L=p.RIFF[0].WEBP[0],x=L.indexOf("¬ù*"),h=0,j=[];h<4;h++)j[h]=L.charCodeAt(x+3+h);var V,z,q;return q=j[1]<<8|j[0],V=q&16383,q=j[3]<<8|j[2],z=q&16383,{width:V,height:z,data:L,riff:p}}function R(p,L){return parseInt(p.substr(L+4,4).split("").map(function(x){var h=x.charCodeAt(0).toString(2);return new Array(8-h.length+1).join("0")+h}).join(""),2)}function E(p){for(var L=0,x={};L<p.length;){var h=p.substr(L,4),j=R(p,L),V=p.substr(L+4+4,j);L+=8+j,x[h]=x[h]||[],h==="RIFF"||h==="LIST"?x[h].push(E(V)):x[h].push(V)}return x}function P(p){return[].slice.call(new Uint8Array(new Float64Array([p]).buffer),0).map(function(L){return String.fromCharCode(L)}).reverse().join("")}var W=new C(w.map(function(p){var L=g(E(atob(p.image.slice(23))));return L.duration=p.duration,L}));postMessage(W)}return o.prototype.compile=function(w){var C=e(a);C.onmessage=function(y){if(y.data.error){console.error(y.data.error);return}w(y.data)},C.postMessage(this.frames)},{Video:o}}();typeof F<"u"&&(F.Whammy=N);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var $={init:function(){var o=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var e=1,a=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),w,C=indexedDB.open(a,e);function y(t){t.createObjectStore(o.dataStoreName)}function u(){var t=w.transaction([o.dataStoreName],"readwrite");o.videoBlob&&t.objectStore(o.dataStoreName).put(o.videoBlob,"videoBlob"),o.gifBlob&&t.objectStore(o.dataStoreName).put(o.gifBlob,"gifBlob"),o.audioBlob&&t.objectStore(o.dataStoreName).put(o.audioBlob,"audioBlob");function f(i){t.objectStore(o.dataStoreName).get(i).onsuccess=function(s){o.callback&&o.callback(s.target.result,i)}}f("audioBlob"),f("videoBlob"),f("gifBlob")}C.onerror=o.onError,C.onsuccess=function(){if(w=C.result,w.onerror=o.onError,w.setVersion)if(w.version!==e){var t=w.setVersion(e);t.onsuccess=function(){y(w),u()}}else u();else u()},C.onupgradeneeded=function(t){y(t.target.result)}},Fetch:function(o){return this.callback=o,this.init(),this},Store:function(o){return this.audioBlob=o.audioBlob,this.videoBlob=o.videoBlob,this.gifBlob=o.gifBlob,this.init(),this},onError:function(o){console.error(JSON.stringify(o,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof F<"u"&&(F.DiskStorage=$);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function ee(o,e){if(typeof GIFEncoder>"u"){var a=document.createElement("script");a.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(a)}e=e||{};var w=o instanceof CanvasRenderingContext2D||o instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(R.record,1e3);return}if(!f){setTimeout(R.record,1e3);return}w||(e.width||(e.width=i.offsetWidth||320),e.height||(e.height=i.offsetHeight||240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),u.width=e.canvas.width||320,u.height=e.canvas.height||240,i.width=e.video.width||320,i.height=e.video.height||240),g=new GIFEncoder,g.setRepeat(0),g.setDelay(e.frameRate||200),g.setQuality(e.quality||10),g.start(),typeof e.onGifRecordingStarted=="function"&&e.onGifRecordingStarted();function E(P){if(R.clearedRecordedData!==!0){if(C)return setTimeout(function(){E(P)},100);s=K(E),typeof d===void 0&&(d=P),!(P-d<90)&&(!w&&i.paused&&i.play(),w||t.drawImage(i,0,0,u.width,u.height),e.onGifPreview&&e.onGifPreview(u.toDataURL("image/png")),g.addFrame(t),d=P)}}s=K(E),e.initCallback&&e.initCallback()},this.stop=function(E){E=E||function(){},s&&l(s),this.blob=new Blob([new Uint8Array(g.stream().bin)],{type:"image/gif"}),E(this.blob),g.stream().bin=[]};var C=!1;this.pause=function(){C=!0},this.resume=function(){C=!1},this.clearRecordedData=function(){R.clearedRecordedData=!0,y()};function y(){g&&(g.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var u=document.createElement("canvas"),t=u.getContext("2d");w&&(o instanceof CanvasRenderingContext2D?(t=o,u=t.canvas):o instanceof HTMLCanvasElement&&(t=o.getContext("2d"),u=o));var f=!0;if(!w){var i=document.createElement("video");i.muted=!0,i.autoplay=!0,i.playsInline=!0,f=!1,i.onloadedmetadata=function(){f=!0},J(o,i),i.play()}var s=null,d,g,R=this}typeof F<"u"&&(F.GifRecorder=ee);function X(o,e){var a="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(h){typeof F<"u"||h&&(typeof window<"u"||typeof re>"u"||(re.navigator={userAgent:a,getUserMedia:function(){}},re.console||(re.console={}),(typeof re.console.log>"u"||typeof re.console.error>"u")&&(re.console.error=re.console.log=re.console.log||function(){console.log(arguments)}),typeof document>"u"&&(h.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var j={getContext:function(){return j},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return j},h.HTMLVideoElement=function(){}),typeof location>"u"&&(h.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(h.screen={width:0,height:0}),typeof i>"u"&&(h.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),h.window=re))})(typeof re<"u"?re:null),e=e||"multi-streams-mixer";var w=[],C=!1,y=document.createElement("canvas"),u=y.getContext("2d");y.style.opacity=0,y.style.position="absolute",y.style.zIndex=-1,y.style.top="-1000em",y.style.left="-1000em",y.className=e,(document.body||document.documentElement).appendChild(y),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var t=this,f=window.AudioContext;typeof f>"u"&&(typeof webkitAudioContext<"u"&&(f=webkitAudioContext),typeof mozAudioContext<"u"&&(f=mozAudioContext));var i=window.URL;typeof i>"u"&&typeof webkitURL<"u"&&(i=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var s=window.MediaStream;typeof s>"u"&&typeof webkitMediaStream<"u"&&(s=webkitMediaStream),typeof s<"u"&&typeof s.prototype.stop>"u"&&(s.prototype.stop=function(){this.getTracks().forEach(function(h){h.stop()})});var d={};typeof f<"u"?d.AudioContext=f:typeof webkitAudioContext<"u"&&(d.AudioContext=webkitAudioContext);function g(h,j){"srcObject"in j?j.srcObject=h:"mozSrcObject"in j?j.mozSrcObject=h:j.srcObject=h}this.startDrawingFrames=function(){R()};function R(){if(!C){var h=w.length,j=!1,V=[];if(w.forEach(function(q){q.stream||(q.stream={}),q.stream.fullcanvas?j=q:V.push(q)}),j)y.width=j.stream.width,y.height=j.stream.height;else if(V.length){y.width=h>1?V[0].width*2:V[0].width;var z=1;(h===3||h===4)&&(z=2),(h===5||h===6)&&(z=3),(h===7||h===8)&&(z=4),(h===9||h===10)&&(z=5),y.height=V[0].height*z}else y.width=t.width||360,y.height=t.height||240;j&&j instanceof HTMLVideoElement&&E(j),V.forEach(function(q,Z){E(q,Z)}),setTimeout(R,t.frameInterval)}}function E(h,j){if(!C){var V=0,z=0,q=h.width,Z=h.height;j===1&&(V=h.width),j===2&&(z=h.height),j===3&&(V=h.width,z=h.height),j===4&&(z=h.height*2),j===5&&(V=h.width,z=h.height*2),j===6&&(z=h.height*3),j===7&&(V=h.width,z=h.height*3),typeof h.stream.left<"u"&&(V=h.stream.left),typeof h.stream.top<"u"&&(z=h.stream.top),typeof h.stream.width<"u"&&(q=h.stream.width),typeof h.stream.height<"u"&&(Z=h.stream.height),u.drawImage(h,V,z,q,Z),typeof h.stream.onRender=="function"&&h.stream.onRender(u,V,z,q,Z,j)}}function P(){C=!1;var h=W(),j=p();return j&&j.getTracks().filter(function(V){return V.kind==="audio"}).forEach(function(V){h.addTrack(V)}),o.forEach(function(V){V.fullcanvas}),h}function W(){x();var h;"captureStream"in y?h=y.captureStream():"mozCaptureStream"in y?h=y.mozCaptureStream():t.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var j=new s;return h.getTracks().filter(function(V){return V.kind==="video"}).forEach(function(V){j.addTrack(V)}),y.stream=j,j}function p(){d.AudioContextConstructor||(d.AudioContextConstructor=new d.AudioContext),t.audioContext=d.AudioContextConstructor,t.audioSources=[],t.useGainNode===!0&&(t.gainNode=t.audioContext.createGain(),t.gainNode.connect(t.audioContext.destination),t.gainNode.gain.value=0);var h=0;if(o.forEach(function(j){if(j.getTracks().filter(function(z){return z.kind==="audio"}).length){h++;var V=t.audioContext.createMediaStreamSource(j);t.useGainNode===!0&&V.connect(t.gainNode),t.audioSources.push(V)}}),!!h)return t.audioDestination=t.audioContext.createMediaStreamDestination(),t.audioSources.forEach(function(j){j.connect(t.audioDestination)}),t.audioDestination.stream}function L(h){var j=document.createElement("video");return g(h,j),j.className=e,j.muted=!0,j.volume=0,j.width=h.width||t.width||360,j.height=h.height||t.height||240,j.play(),j}this.appendStreams=function(h){if(!h)throw"First parameter is required.";h instanceof Array||(h=[h]),h.forEach(function(j){var V=new s;if(j.getTracks().filter(function(Z){return Z.kind==="video"}).length){var z=L(j);z.stream=j,w.push(z),V.addTrack(j.getTracks().filter(function(Z){return Z.kind==="video"})[0])}if(j.getTracks().filter(function(Z){return Z.kind==="audio"}).length){var q=t.audioContext.createMediaStreamSource(j);t.audioDestination=t.audioContext.createMediaStreamDestination(),q.connect(t.audioDestination),V.addTrack(t.audioDestination.stream.getTracks().filter(function(Z){return Z.kind==="audio"})[0])}o.push(V)})},this.releaseStreams=function(){w=[],C=!0,t.gainNode&&(t.gainNode.disconnect(),t.gainNode=null),t.audioSources.length&&(t.audioSources.forEach(function(h){h.disconnect()}),t.audioSources=[]),t.audioDestination&&(t.audioDestination.disconnect(),t.audioDestination=null),t.audioContext&&t.audioContext.close(),t.audioContext=null,u.clearRect(0,0,y.width,y.height),y.stream&&(y.stream.stop(),y.stream=null)},this.resetVideoStreams=function(h){h&&!(h instanceof Array)&&(h=[h]),x(h)};function x(h){w=[],h=h||o,h.forEach(function(j){if(j.getTracks().filter(function(z){return z.kind==="video"}).length){var V=L(j);V.stream=j,w.push(V)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=P}typeof F>"u"&&(Te.exports=X);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function A(o,e){o=o||[];var a=this,w,C;e=e||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},e.frameInterval||(e.frameInterval=10),e.video||(e.video={}),e.video.width||(e.video.width=360),e.video.height||(e.video.height=240),this.record=function(){w=new X(o,e.elementClass||"multi-streams-mixer"),y().length&&(w.frameInterval=e.frameInterval||10,w.width=e.video.width||360,w.height=e.video.height||240,w.startDrawingFrames()),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(w.getMixedStream()),C=new m(w.getMixedStream(),e),C.record()};function y(){var u=[];return o.forEach(function(t){_(t,"video").forEach(function(f){u.push(f)})}),u}this.stop=function(u){C&&C.stop(function(t){a.blob=t,u(t),a.clearRecordedData()})},this.pause=function(){C&&C.pause()},this.resume=function(){C&&C.resume()},this.clearRecordedData=function(){C&&(C.clearRecordedData(),C=null),w&&(w.releaseStreams(),w=null)},this.addStreams=function(u){if(!u)throw"First parameter is required.";u instanceof Array||(u=[u]),o.concat(u),!(!C||!w)&&(w.appendStreams(u),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(w.getMixedStream()))},this.resetVideoStreams=function(u){w&&(u&&!(u instanceof Array)&&(u=[u]),w.resetVideoStreams(u))},this.getMixer=function(){return w},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof F<"u"&&(F.MultiStreamRecorder=A);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function te(o,e){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof o>"u")throw'First argument "MediaStream" is required.';var a=this;a.recordRTC=new F(o,e),this.startRecording=function(){return new Promise(function(w,C){try{a.recordRTC.startRecording(),w()}catch(y){C(y)}})},this.stopRecording=function(){return new Promise(function(w,C){try{a.recordRTC.stopRecording(function(y){if(a.blob=a.recordRTC.getBlob(),!a.blob||!a.blob.size){C("Empty blob.",a.blob);return}w(y)})}catch(y){C(y)}})},this.pauseRecording=function(){return new Promise(function(w,C){try{a.recordRTC.pauseRecording(),w()}catch(y){C(y)}})},this.resumeRecording=function(){return new Promise(function(w,C){try{a.recordRTC.resumeRecording(),w()}catch(y){C(y)}})},this.getDataURL=function(w){return new Promise(function(C,y){try{a.recordRTC.getDataURL(function(u){C(u)})}catch(u){y(u)}})},this.getBlob=function(){return new Promise(function(w,C){try{w(a.recordRTC.getBlob())}catch(y){C(y)}})},this.getInternalRecorder=function(){return new Promise(function(w,C){try{w(a.recordRTC.getInternalRecorder())}catch(y){C(y)}})},this.reset=function(){return new Promise(function(w,C){try{w(a.recordRTC.reset())}catch(y){C(y)}})},this.destroy=function(){return new Promise(function(w,C){try{w(a.recordRTC.destroy())}catch(y){C(y)}})},this.getState=function(){return new Promise(function(w,C){try{w(a.recordRTC.getState())}catch(y){C(y)}})},this.blob=null,this.version="5.6.2"}typeof F<"u"&&(F.RecordRTCPromisesHandler=te);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function Q(o,e){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),e=e||{},e.width=e.width||640,e.height=e.height||480,e.frameRate=e.frameRate||30,e.bitrate=e.bitrate||1200,e.realtime=e.realtime||!0;var a;function w(){return new ReadableStream({start:function(i){var s=document.createElement("canvas"),d=document.createElement("video"),g=!0;d.srcObject=o,d.muted=!0,d.height=e.height,d.width=e.width,d.volume=0,d.onplaying=function(){s.width=e.width,s.height=e.height;var R=s.getContext("2d"),E=1e3/e.frameRate,P=setInterval(function(){if(a&&(clearInterval(P),i.close()),g&&(g=!1,e.onVideoProcessStarted&&e.onVideoProcessStarted()),R.drawImage(d,0,0),i._controlledReadableStream.state!=="closed")try{i.enqueue(R.getImageData(0,0,e.width,e.height))}catch{}},E)},d.play()}})}var C;function y(i,s){if(!e.workerPath&&!s){a=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(g){g.arrayBuffer().then(function(R){y(i,R)})});return}if(!e.workerPath&&s instanceof ArrayBuffer){var d=new Blob([s],{type:"text/javascript"});e.workerPath=n.createObjectURL(d)}e.workerPath||console.error("workerPath parameter is missing."),C=new Worker(e.workerPath),C.postMessage(e.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),C.addEventListener("message",function(g){g.data==="READY"?(C.postMessage({width:e.width,height:e.height,bitrate:e.bitrate||1200,timebaseDen:e.frameRate||30,realtime:e.realtime}),w().pipeTo(new WritableStream({write:function(R){if(a){console.error("Got image, but recorder is finished!");return}C.postMessage(R.data.buffer,[R.data.buffer])}}))):g.data&&(u||f.push(g.data))})}this.record=function(){f=[],u=!1,this.blob=null,y(o),typeof e.initCallback=="function"&&e.initCallback()};var u;this.pause=function(){u=!0},this.resume=function(){u=!1};function t(i){if(!C){i&&i();return}C.addEventListener("message",function(s){s.data===null&&(C.terminate(),C=null,i&&i())}),C.postMessage(null)}var f=[];this.stop=function(i){a=!0;var s=this;t(function(){s.blob=new Blob(f,{type:"video/webm"}),i(s.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){f=[],u=!1,this.blob=null},this.blob=null}typeof F<"u"&&(F.WebAssemblyRecorder=Q)}(_e)),_e.exports}var qe=Ye();const et=We(qe);var Ne={exports:{}};/*!
 * videojs-record
 * @version 4.8.0
 * @see https://github.com/collab-project/videojs-record
 * @copyright 2014-2024 Collab
 * @license MIT
 */var Ge;function tt(){return Ge||(Ge=1,function(Te,F){(function(ye,he){Te.exports=he(Ye(),Ze)})(self,(ge,ye)=>(()=>{var he={"./node_modules/add-zero/index.js":function(l,r,n){var c;(function(O){function D(v,T){T=T||2;var b=Number(v)<0,S=v.toString(),I=0;return b&&(S=S.slice(1)),I=T-S.length+1,S=new Array(I).join("0").concat(S),(b?"-":"")+S}c=(function(){return D}).call(O,n,O,l),c!==void 0&&(l.exports=c)})(this)},"./src/js/controls/animation-display.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),D=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),v=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),T=c(n("./node_modules/@babel/runtime/helpers/get.js")),b=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),S=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),I=c(n("video.js"));function B(Y,k,m){return k=(0,b.default)(k),(0,v.default)(Y,_()?Reflect.construct(k,m||[],(0,b.default)(Y).constructor):k.apply(Y,m))}function _(){try{var Y=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_=function(){return!!Y})()}var J=I.default.getComponent("Component"),H=function(Y){function k(){return(0,O.default)(this,k),B(this,k,arguments)}return(0,S.default)(k,Y),(0,D.default)(k,[{key:"createEl",value:function(){var M=I.default.dom.createEl("img"),U=(0,T.default)((0,b.default)(k.prototype),"createEl",this).call(this,"div",{className:"vjs-animation-display",dir:"ltr"});return U.appendChild(M),U}}])}(J);J.registerComponent("AnimationDisplay",H),r.default=H,l.exports=r.default},"./src/js/controls/camera-button.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),D=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),v=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),T=c(n("./node_modules/@babel/runtime/helpers/get.js")),b=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),S=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),I=c(n("video.js")),B=c(n("./src/js/event.js"));function _(m,M,U){return M=(0,b.default)(M),(0,v.default)(m,J()?Reflect.construct(M,U||[],(0,b.default)(m).constructor):M.apply(m,U))}function J(){try{var m=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(J=function(){return!!m})()}var H=I.default.getComponent("Button"),Y=I.default.getComponent("Component"),k=function(m){function M(){return(0,O.default)(this,M),_(this,M,arguments)}return(0,S.default)(M,m),(0,D.default)(M,[{key:"buildCSSClass",value:function(){return"vjs-camera-button vjs-control vjs-button vjs-icon-photo-camera"}},{key:"enable",value:function(){(0,T.default)((0,b.default)(M.prototype),"enable",this).call(this),this.on(this.player_,B.default.START_RECORD,this.onStart),this.on(this.player_,B.default.STOP_RECORD,this.onStop)}},{key:"disable",value:function(){(0,T.default)((0,b.default)(M.prototype),"disable",this).call(this),this.off(this.player_,B.default.START_RECORD,this.onStart),this.off(this.player_,B.default.STOP_RECORD,this.onStop)}},{key:"show",value:function(){this.layoutExclude&&this.layoutExclude===!0||(0,T.default)((0,b.default)(M.prototype),"show",this).call(this)}},{key:"handleClick",value:function(G){var N=this.player_.record();N.isProcessing()?(N.retrySnapshot(),this.onStop(),this.player_.trigger(B.default.RETRY)):N.start()}},{key:"onStart",value:function(G){this.removeClass("vjs-icon-photo-camera"),this.addClass("vjs-icon-replay"),this.controlText("Retry")}},{key:"onStop",value:function(G){this.removeClass("vjs-icon-replay"),this.addClass("vjs-icon-photo-camera"),this.controlText("Image")}}])}(H);k.prototype.controlText_="Image",Y.registerComponent("CameraButton",k),r.default=k,l.exports=r.default},"./src/js/controls/device-button.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),D=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),v=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),T=c(n("./node_modules/@babel/runtime/helpers/get.js")),b=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),S=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),I=c(n("video.js"));function B(k,m,M){return m=(0,b.default)(m),(0,v.default)(k,_()?Reflect.construct(m,M||[],(0,b.default)(k).constructor):m.apply(k,M))}function _(){try{var k=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_=function(){return!!k})()}var J=I.default.getComponent("Button"),H=I.default.getComponent("Component"),Y=function(k){function m(){return(0,O.default)(this,m),B(this,m,arguments)}return(0,S.default)(m,k),(0,D.default)(m,[{key:"handleClick",value:function(U){this.player_.record().getDevice()}},{key:"show",value:function(){this.layoutExclude&&this.layoutExclude===!0||(0,T.default)((0,b.default)(m.prototype),"show",this).call(this)}}])}(J);Y.prototype.controlText_="Device",H.registerComponent("DeviceButton",Y),r.default=Y,l.exports=r.default},"./src/js/controls/picture-in-picture-toggle.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/@babel/runtime/regenerator/index.js")),D=c(n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),v=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),T=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),b=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),S=c(n("./node_modules/@babel/runtime/helpers/get.js")),I=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),B=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),_=c(n("video.js")),J=c(n("./src/js/event.js"));function H(U,G,N){return G=(0,I.default)(G),(0,b.default)(U,Y()?Reflect.construct(G,N||[],(0,I.default)(U).constructor):G.apply(U,N))}function Y(){try{var U=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Y=function(){return!!U})()}var k=_.default.getComponent("Button"),m=_.default.getComponent("Component"),M=function(U){function G(N,$){var ee;return(0,v.default)(this,G),ee=H(this,G,[N,$]),ee.on(ee.player_,J.default.ENTER_PIP,ee.onStart),ee.on(ee.player_,J.default.LEAVE_PIP,ee.onStop),ee}return(0,B.default)(G,U),(0,T.default)(G,[{key:"buildCSSClass",value:function(){return"vjs-pip-button vjs-control vjs-button vjs-icon-picture-in-picture-start"}},{key:"show",value:function(){this.layoutExclude&&this.layoutExclude===!0||(0,S.default)((0,I.default)(G.prototype),"show",this).call(this)}},{key:"handleClick",value:function(){var N=(0,D.default)(O.default.mark(function ee(X){var A;return O.default.wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(A=this.player_.record(),this.disable(),Q.prev=2,A.mediaElement===document.pictureInPictureElement){Q.next=8;break}return Q.next=6,A.mediaElement.requestPictureInPicture();case 6:Q.next=10;break;case 8:return Q.next=10,document.exitPictureInPicture();case 10:Q.next=15;break;case 12:Q.prev=12,Q.t0=Q.catch(2),this.player_.trigger(J.default.ERROR,Q.t0);case 15:return Q.prev=15,this.enable(),Q.finish(15);case 18:case"end":return Q.stop()}},ee,this,[[2,12,15,18]])}));function $(ee){return N.apply(this,arguments)}return $}()},{key:"onStart",value:function($){this.removeClass("vjs-icon-picture-in-picture-start"),this.addClass("vjs-icon-picture-in-picture-stop")}},{key:"onStop",value:function($){this.removeClass("vjs-icon-picture-in-picture-stop"),this.addClass("vjs-icon-picture-in-picture-start")}}])}(k);M.prototype.controlText_="Picture in Picture",m.registerComponent("PictureInPictureToggle",M),r.default=M,l.exports=r.default},"./src/js/controls/record-canvas.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),D=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),v=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),T=c(n("./node_modules/@babel/runtime/helpers/get.js")),b=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),S=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),I=c(n("video.js"));function B(Y,k,m){return k=(0,b.default)(k),(0,v.default)(Y,_()?Reflect.construct(k,m||[],(0,b.default)(Y).constructor):k.apply(Y,m))}function _(){try{var Y=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_=function(){return!!Y})()}var J=I.default.getComponent("Component"),H=function(Y){function k(){return(0,O.default)(this,k),B(this,k,arguments)}return(0,S.default)(k,Y),(0,D.default)(k,[{key:"createEl",value:function(){var M=I.default.dom.createEl("canvas"),U=(0,T.default)((0,b.default)(k.prototype),"createEl",this).call(this,"div",{className:"vjs-record-canvas",dir:"ltr"});return U.appendChild(M),U}}])}(J);J.registerComponent("RecordCanvas",H),r.default=H,l.exports=r.default},"./src/js/controls/record-indicator.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),D=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),v=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),T=c(n("./node_modules/@babel/runtime/helpers/get.js")),b=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),S=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),I=c(n("video.js")),B=c(n("./src/js/event.js"));function _(k,m,M){return m=(0,b.default)(m),(0,v.default)(k,J()?Reflect.construct(m,M||[],(0,b.default)(k).constructor):m.apply(k,M))}function J(){try{var k=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(J=function(){return!!k})()}var H=I.default.getComponent("Component"),Y=function(k){function m(M,U){var G;return(0,O.default)(this,m),G=_(this,m,[M,U]),G.enable(),G}return(0,S.default)(m,k),(0,D.default)(m,[{key:"createEl",value:function(){var U={className:"vjs-record-indicator vjs-control",dir:"ltr"},G={"data-label":this.localize("REC")};return(0,T.default)((0,b.default)(m.prototype),"createEl",this).call(this,"div",U,G)}},{key:"enable",value:function(){this.on(this.player_,B.default.START_RECORD,this.show),this.on(this.player_,B.default.STOP_RECORD,this.hide)}},{key:"disable",value:function(){this.off(this.player_,B.default.START_RECORD,this.show),this.off(this.player_,B.default.STOP_RECORD,this.hide)}},{key:"show",value:function(){this.layoutExclude&&this.layoutExclude===!0||(0,T.default)((0,b.default)(m.prototype),"show",this).call(this)}}])}(H);H.registerComponent("RecordIndicator",Y),r.default=Y,l.exports=r.default},"./src/js/controls/record-toggle.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),D=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),v=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),T=c(n("./node_modules/@babel/runtime/helpers/get.js")),b=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),S=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),I=c(n("video.js")),B=c(n("./src/js/event.js"));function _(m,M,U){return M=(0,b.default)(M),(0,v.default)(m,J()?Reflect.construct(M,U||[],(0,b.default)(m).constructor):M.apply(m,U))}function J(){try{var m=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(J=function(){return!!m})()}var H=I.default.getComponent("Button"),Y=I.default.getComponent("Component"),k=function(m){function M(){return(0,O.default)(this,M),_(this,M,arguments)}return(0,S.default)(M,m),(0,D.default)(M,[{key:"buildCSSClass",value:function(){return"vjs-record-button vjs-control vjs-button vjs-icon-record-start"}},{key:"enable",value:function(){(0,T.default)((0,b.default)(M.prototype),"enable",this).call(this),this.on(this.player_,B.default.START_RECORD,this.onStart),this.on(this.player_,B.default.STOP_RECORD,this.onStop)}},{key:"disable",value:function(){(0,T.default)((0,b.default)(M.prototype),"disable",this).call(this),this.off(this.player_,B.default.START_RECORD,this.onStart),this.off(this.player_,B.default.STOP_RECORD,this.onStop)}},{key:"show",value:function(){this.layoutExclude&&this.layoutExclude===!0||(0,T.default)((0,b.default)(M.prototype),"show",this).call(this)}},{key:"handleClick",value:function(G){var N=this.player_.record();N.isRecording()?N.stop():N.start()}},{key:"onStart",value:function(G){this.removeClass("vjs-icon-record-start"),this.addClass("vjs-icon-record-stop"),this.controlText("Stop")}},{key:"onStop",value:function(G){this.removeClass("vjs-icon-record-stop"),this.addClass("vjs-icon-record-start"),this.controlText("Record")}}])}(H);k.prototype.controlText_="Record",Y.registerComponent("RecordToggle",k),r.default=k,l.exports=r.default},"./src/js/defaults.js":(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={image:!1,audio:!1,video:!1,animation:!1,screen:!1,maxLength:10,maxFileSize:0,displayMilliseconds:!1,formatTime:void 0,frameWidth:320,frameHeight:240,debug:!1,pip:!1,autoMuteDevice:!1,videoBitRate:1200,videoEngine:"recordrtc",videoFrameRate:30,videoMimeType:"video/webm",videoRecorderType:"auto",videoWorkerURL:"",videoWebAssemblyURL:"",audioEngine:"recordrtc",audioRecorderType:"auto",audioMimeType:"auto",audioBufferSize:4096,audioSampleRate:44100,audioBitRate:128,audioChannels:2,audioWorkerURL:"",audioWebAssemblyURL:"",audioBufferUpdate:!1,animationFrameRate:200,animationQuality:10,imageOutputType:"dataURL",imageOutputFormat:"image/png",imageOutputQuality:.92,timeSlice:0,convertEngine:"",convertWorkerURL:"",convertOptions:[],convertAuto:!0,hotKeys:!1,pluginLibraryOptions:{}};r.default=n,l.exports=r.default},"./src/js/engine/convert-engine.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.TSEBML=r.FFMPEGWASM=r.FFMPEGJS=r.ConvertEngine=r.CONVERT_PLUGINS=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),D=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),v=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),T=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),b=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),S=c(n("video.js")),I=n("./src/js/utils/file-util.js");function B(M,U,G){return U=(0,T.default)(U),(0,v.default)(M,_()?Reflect.construct(U,G||[],(0,T.default)(M).constructor):U.apply(M,G))}function _(){try{var M=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_=function(){return!!M})()}var J=S.default.getComponent("Component"),H=r.TSEBML="ts-ebml",Y=r.FFMPEGJS="ffmpeg.js",k=r.FFMPEGWASM="ffmpeg.wasm";r.CONVERT_PLUGINS=[H,Y,k];var m=r.ConvertEngine=function(M){function U(G,N){return(0,O.default)(this,U),N.evented=!0,B(this,U,[G,N])}return(0,b.default)(U,M),(0,D.default)(U,[{key:"setup",value:function(N,$){this.mediaType=N,this.debug=$}},{key:"loadBlob",value:function(N){return(0,I.blobToArrayBuffer)(N)}},{key:"addFileInfo",value:function(N,$){(0,I.addFileInfo)(N,$)}},{key:"saveAs",value:function(N){var $=N[Object.keys(N)[0]];(0,I.downloadBlob)($,this.player().convertedData)}}])}(J);S.default.ConvertEngine=m,J.registerComponent("ConvertEngine",m)},"./src/js/engine/engine-loader.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.isAudioPluginActive=r.getVideoEngine=r.getConvertEngine=r.getAudioEngine=void 0;var O=c(n("video.js")),D=c(n("./src/js/engine/record-rtc.js")),v=n("./src/js/engine/convert-engine.js"),T=n("./src/js/engine/record-engine.js");r.getAudioEngine=function(S){var I;switch(S){case T.RECORDRTC:I=D.default;break;case T.LIBVORBISJS:I=O.default.LibVorbisEngine;break;case T.RECORDERJS:I=O.default.RecorderjsEngine;break;case T.LAMEJS:I=O.default.LamejsEngine;break;case T.OPUSRECORDER:I=O.default.OpusRecorderEngine;break;case T.OPUSMEDIARECORDER:I=O.default.OpusMediaRecorderEngine;break;case T.VMSG:I=O.default.VmsgEngine;break;default:throw new Error("Unknown audioEngine: "+S)}return I},r.getVideoEngine=function(S){var I;switch(S){case T.RECORDRTC:I=D.default;break;case T.WEBMWASM:I=O.default.WebmWasmEngine;break;default:throw new Error("Unknown videoEngine: "+S)}return I},r.isAudioPluginActive=function(S){return T.AUDIO_PLUGINS.indexOf(S)>-1},r.getConvertEngine=function(S){var I;switch(S){case"":break;case v.TSEBML:I=O.default.TsEBMLEngine;break;case v.FFMPEGJS:I=O.default.FFmpegjsEngine;break;case v.FFMPEGWASM:I=O.default.FFmpegWasmEngine;break;default:throw new Error("Unknown convertEngine: "+S)}return I}},"./src/js/engine/record-engine.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.WEBMWASM=r.VMSG=r.VIDEO_PLUGINS=r.RecordEngine=r.RECORD_PLUGINS=r.RECORDRTC=r.RECORDERJS=r.OPUSRECORDER=r.OPUSMEDIARECORDER=r.LIBVORBISJS=r.LAMEJS=r.AUDIO_PLUGINS=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),D=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),v=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),T=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),b=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),S=c(n("video.js")),I=c(n("./src/js/event.js")),B=n("./src/js/utils/file-util.js");function _(A,te,Q){return te=(0,T.default)(te),(0,v.default)(A,J()?Reflect.construct(te,Q||[],(0,T.default)(A).constructor):te.apply(A,Q))}function J(){try{var A=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(J=function(){return!!A})()}var H=S.default.getComponent("Component");r.RECORDRTC="recordrtc";var Y=r.LIBVORBISJS="libvorbis.js",k=r.RECORDERJS="recorder.js",m=r.LAMEJS="lamejs",M=r.OPUSRECORDER="opus-recorder",U=r.OPUSMEDIARECORDER="opus-media-recorder",G=r.VMSG="vmsg",N=r.WEBMWASM="webm-wasm",$=r.AUDIO_PLUGINS=[Y,k,m,M,U,G],ee=r.VIDEO_PLUGINS=[N];r.RECORD_PLUGINS=$.concat(ee);var X=r.RecordEngine=function(A){function te(Q,o){return(0,O.default)(this,te),o.evented=!0,_(this,te,[Q,o])}return(0,b.default)(te,A),(0,D.default)(te,[{key:"dispose",value:function(){this.recordedData!==void 0&&URL.revokeObjectURL(this.recordedData)}},{key:"destroy",value:function(){}},{key:"addFileInfo",value:function(o){(0,B.addFileInfo)(o)}},{key:"onStopRecording",value:function(o){this.recordedData=o,this.addFileInfo(this.recordedData),this.dispose(),this.trigger(I.default.RECORD_COMPLETE)}},{key:"saveAs",value:function(o){var e=o[Object.keys(o)[0]];(0,B.downloadBlob)(e,this.recordedData)}}])}(H);S.default.RecordEngine=X,H.registerComponent("RecordEngine",X)},"./src/js/engine/record-mode.js":(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getRecorderMode=r.VIDEO_ONLY=r.SCREEN_ONLY=r.IMAGE_ONLY=r.AUDIO_VIDEO=r.AUDIO_SCREEN=r.AUDIO_ONLY=r.ANIMATION=void 0;var n=r.IMAGE_ONLY="image_only",c=r.AUDIO_ONLY="audio_only",O=r.VIDEO_ONLY="video_only",D=r.AUDIO_VIDEO="audio_video",v=r.AUDIO_SCREEN="audio_screen",T=r.ANIMATION="animation",b=r.SCREEN_ONLY="screen_only";r.getRecorderMode=function(B,_,J,H,Y){if(S(B))return n;if(S(H))return T;if(S(_)&&S(J))return D;if(S(_)&&S(Y))return v;if(!S(_)&&S(Y))return b;if(S(_)&&!S(J))return c;if(!S(_)&&S(J))return O};var S=function(B){return B===Object(B)||B===!0}},"./src/js/engine/record-rtc.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),D=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),v=c(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),T=c(n("./node_modules/@babel/runtime/helpers/get.js")),b=c(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),S=c(n("./node_modules/@babel/runtime/helpers/inherits.js")),I=c(n("video.js")),B=c(n("recordrtc")),_=c(n("./src/js/event.js")),J=n("./src/js/engine/record-engine.js");n("./src/js/utils/detect-browser.js");var H=n("./src/js/engine/record-mode.js");function Y(U,G,N){return G=(0,b.default)(G),(0,v.default)(U,k()?Reflect.construct(G,N||[],(0,b.default)(U).constructor):G.apply(U,N))}function k(){try{var U=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(k=function(){return!!U})()}var m=I.default.getComponent("Component"),M=function(U){function G(){return(0,O.default)(this,G),Y(this,G,arguments)}return(0,S.default)(G,U),(0,D.default)(G,[{key:"setup",value:function($,ee,X){this.inputStream=$,this.mediaType=ee,this.debug=X,"screen"in this.mediaType&&(this.mediaType.video=!0),this.recorderType!==void 0&&(this.mediaType.video=this.recorderType),this.engine=new B.default.MRecordRTC,this.engine.mediaType=this.mediaType,this.engine.disableLogs=!this.debug,this.engine.mimeType=this.mimeType,this.engine.bufferSize=this.bufferSize,this.engine.sampleRate=this.sampleRate,this.engine.numberOfAudioChannels=this.audioChannels,this.engine.video=this.video,this.engine.canvas=this.canvas,this.engine.bitrate=this.bitRate,this.engine.quality=this.quality,this.engine.frameRate=this.frameRate,this.timeSlice!==void 0&&(this.engine.timeSlice=this.timeSlice,this.engine.onTimeStamp=this.onTimeStamp.bind(this)),this.engine.workerPath=this.workerPath,this.engine.webAssemblyPath=this.videoWebAssemblyURL,this.engine.addStream(this.inputStream)}},{key:"dispose",value:function(){(0,T.default)((0,b.default)(G.prototype),"dispose",this).call(this),this.destroy()}},{key:"destroy",value:function(){this.engine&&typeof this.engine.destroy=="function"&&this.engine.destroy()}},{key:"start",value:function(){this.engine.startRecording()}},{key:"stop",value:function(){this.engine.stopRecording(this.onStopRecording.bind(this))}},{key:"pause",value:function(){this.engine.pauseRecording()}},{key:"resume",value:function(){this.engine.resumeRecording()}},{key:"saveAs",value:function($){this.engine&&$!==void 0&&this.engine.save($)}},{key:"onStopRecording",value:function($,ee){var X=this;URL.revokeObjectURL($);var A=this.player().record().getRecordType();this.engine.getBlob(function(te){switch(A){case H.AUDIO_ONLY:te.audio!==void 0&&(X.recordedData=te.audio);break;case H.VIDEO_ONLY:case H.AUDIO_VIDEO:case H.AUDIO_SCREEN:case H.SCREEN_ONLY:te.video!==void 0&&(X.recordedData=te.video);break;case H.ANIMATION:te.gif!==void 0&&(X.recordedData=te.gif);break}X.addFileInfo(X.recordedData),X.trigger(_.default.RECORD_COMPLETE)})}},{key:"onTimeStamp",value:function($,ee){this.player().currentTimestamp=$,this.player().allTimestamps=ee;var X;switch(this.player().record().getRecordType()){case H.AUDIO_ONLY:X=this.engine.audioRecorder;break;case H.ANIMATION:X=this.engine.gifRecorder;break;default:X=this.engine.videoRecorder}var A=!1;if(X&&(X=X.getInternalRecorder()),X instanceof B.default.MediaStreamRecorder&&(this.player().recordedData=X.getArrayOfBlobs(),this.addFileInfo(this.player().recordedData[this.player_.recordedData.length-1]),this.maxFileSize>0)){var te=new Blob(this.player().recordedData).size;te>=this.maxFileSize&&(A=!0)}this.player().trigger(_.default.TIMESTAMP),A&&this.player().record().stop()}}])}(J.RecordEngine);I.default.RecordRTCEngine=M,m.registerComponent("RecordRTCEngine",M),r.default=M,l.exports=r.default},"./src/js/event.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/@babel/runtime/helpers/createClass.js")),D=c(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),v=(0,O.default)(function T(){(0,D.default)(this,T)});v.READY="ready",v.ERROR="error",v.PLAYING="playing",v.LOADEDMETADATA="loadedmetadata",v.LOADSTART="loadstart",v.USERINACTIVE="userinactive",v.TIMEUPDATE="timeupdate",v.DURATIONCHANGE="durationchange",v.ENDED="ended",v.PAUSE="pause",v.PLAY="play",v.DEVICE_READY="deviceReady",v.DEVICE_ERROR="deviceError",v.START_RECORD="startRecord",v.STOP_RECORD="stopRecord",v.FINISH_RECORD="finishRecord",v.RECORD_COMPLETE="recordComplete",v.PROGRESS_RECORD="progressRecord",v.TIMESTAMP="timestamp",v.ENUMERATE_READY="enumerateReady",v.ENUMERATE_ERROR="enumerateError",v.AUDIO_BUFFER_UPDATE="audioBufferUpdate",v.AUDIO_OUTPUT_READY="audioOutputReady",v.START_CONVERT="startConvert",v.FINISH_CONVERT="finishConvert",v.ENTER_PIP="enterPIP",v.LEAVE_PIP="leavePIP",v.RETRY="retry",v.ENTERPICTUREINPICTURE="enterpictureinpicture",v.LEAVEPICTUREINPICTURE="leavepictureinpicture",Object.freeze(v),r.default=v,l.exports=r.default},"./src/js/hot-keys.js":(l,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=n("./src/js/engine/record-mode.js"),O=88,D=80,v=67,T=function(S){switch(S.which){case O:switch(this.player_.record().getRecordType()){case c.IMAGE_ONLY:this.player_.cameraButton.trigger("click");break;default:this.player_.recordToggle.trigger("click")}break;case D:this.player_.record().pictureInPicture===!0&&this.player_.pipToggle.trigger("click");break;case v:this.player_.controlBar.playToggle&&this.player_.controlBar.playToggle.contentEl()&&player.controlBar.playToggle.trigger("click");break}};r.default=T,l.exports=r.default},"./src/js/utils/browser-shim.js":(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(O,D){"srcObject"in D?D.srcObject=O:"mozSrcObject"in D?D.mozSrcObject=O:D.srcObject=O};r.default=n,l.exports=r.default},"./src/js/utils/compare-version.js":(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(O,D){if(typeof O!="string"||typeof D!="string")return!1;O=O.split("."),D=D.split(".");var v=Math.min(O.length,D.length),T=0;for(T;T<v;++T){if(O[T]=parseInt(O[T],10),D[T]=parseInt(D[T],10),O[T]>D[T])return 1;if(O[T]<D[T])return-1}return O.length===D.length?0:O.length<D.length?-1:1};r.default=n,l.exports=r.default},"./src/js/utils/detect-browser.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.isSafari=r.isOpera=r.isFirefox=r.isEdge=r.isChrome=r.detectBrowser=void 0;var O=c(n("./node_modules/global/window.js")),D=r.detectBrowser=function(){var b={};if(b.browser=null,b.version=null,b.minVersion=null,typeof O.default>"u"||!O.default.navigator)return b.browser="Not a supported browser.",b;if(navigator.mozGetUserMedia)b.browser="firefox",b.version=v(navigator.userAgent,/Firefox\/(\d+)\./,1),b.minVersion=31;else if(navigator.webkitGetUserMedia)b.browser="chrome",b.version=v(navigator.userAgent,/Chrom(e|ium)\/(\d+)\./,2),b.minVersion=38;else if(navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))b.browser="edge",b.version=v(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),b.minVersion=10547;else if(O.default.RTCPeerConnection&&navigator.userAgent.match(/AppleWebKit\/(\d+)\./))b.browser="safari",b.version=v(navigator.userAgent,/AppleWebKit\/(\d+)\./,1);else return b.browser="Not a supported browser.",b;return b},v=function(b,S,I){var B=b.match(S);return B&&B.length>=I&&parseInt(B[I],10)};r.isEdge=function(){return D().browser==="edge"},r.isSafari=function(){return D().browser==="safari"},r.isOpera=function(){return!!O.default.opera||navigator.userAgent.indexOf("OPR/")!==-1},r.isChrome=function(){return D().browser==="chrome"},r.isFirefox=function(){return D().browser==="firefox"}},"./src/js/utils/file-util.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.downloadBlob=r.blobToArrayBuffer=r.addFileInfo=void 0;var O=c(n("./src/js/utils/mime.js"));r.downloadBlob=function(v,T){if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(T,v);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(T,v);var b=document.createElement("a");b.href=URL.createObjectURL(T),b.download=v,b.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(b),typeof b.click=="function"?b.click():(b.target="_blank",b.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),URL.revokeObjectURL(b.href)},r.blobToArrayBuffer=function(v){return new Promise(function(T,b){var S=new FileReader;S.onloadend=function(){T(S.result)},S.onerror=function(I){b(I.error)},S.readAsArrayBuffer(v)})},r.addFileInfo=function(v,T,b){if(v instanceof Blob||v instanceof File){T===void 0&&(T=new Date);try{v.lastModified=T.getTime(),v.lastModifiedDate=T}catch(S){if(!(S instanceof TypeError))throw S}b===void 0&&(b="."+(0,O.default)(v.type));try{v.name=T.getTime()+b}catch(S){if(!(S instanceof TypeError))throw S}}}},"./src/js/utils/format-time.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var O=c(n("./node_modules/parse-ms/index.js")),D=c(n("./node_modules/add-zero/index.js")),v=function(b,S){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;b=b<0?0:b,(isNaN(b)||b===1/0)&&(b=0);var B=(0,O.default)(b*1e3),_=B;S!==void 0&&(_=(0,O.default)(S*1e3));var J=(0,D.default)(B.hours),H=(0,D.default)(B.minutes),Y=(0,D.default)(B.seconds),k=(0,D.default)(B.milliseconds,3);if(B.days>0||_.days>0){var m=(0,D.default)(B.days);return"".concat(m,":").concat(J,":").concat(H,":").concat(Y)}return B.hours>0||_.hours>0?"".concat(J,":").concat(H,":").concat(Y):I?"".concat(H,":").concat(Y,":").concat(k):"".concat(H,":").concat(Y)};r.default=v,l.exports=r.default},"./src/js/utils/mime.js":(l,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=/^\s*([^;\s]*)(?:;|\s|$)/,c={"video/ogg":"ogv","video/mp4":"mp4","video/x-matroska":"mkv","video/webm":"webm","audio/mp4":"m4a","audio/mpeg":"mp3","audio/aac":"aac","audio/flac":"flac","audio/ogg":"oga","audio/wav":"wav","audio/webm":"webm","application/x-mpegURL":"m3u8","image/jpeg":"jpg","image/gif":"gif","image/png":"png","image/svg+xml":"svg","image/webp":"webp"},O=function(v){var T=n.exec(v),b=T&&T[1].toLowerCase();return c[b]};r.default=O,l.exports=r.default},"./node_modules/global/window.js":(l,r,n)=>{var c;typeof window<"u"?c=window:typeof n.g<"u"?c=n.g:typeof self<"u"?c=self:c={},l.exports=c},recordrtc:l=>{l.exports=ge},"video.js":l=>{l.exports=ye},"./node_modules/@babel/runtime/helpers/assertThisInitialized.js":l=>{function r(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}l.exports=r,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/asyncToGenerator.js":l=>{function r(c,O,D,v,T,b,S){try{var I=c[b](S),B=I.value}catch(_){D(_);return}I.done?O(B):Promise.resolve(B).then(v,T)}function n(c){return function(){var O=this,D=arguments;return new Promise(function(v,T){var b=c.apply(O,D);function S(B){r(b,v,T,S,I,"next",B)}function I(B){r(b,v,T,S,I,"throw",B)}S(void 0)})}}l.exports=n,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/classCallCheck.js":l=>{function r(n,c){if(!(n instanceof c))throw new TypeError("Cannot call a class as a function")}l.exports=r,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/createClass.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/toPropertyKey.js");function O(v,T){for(var b=0;b<T.length;b++){var S=T[b];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(v,c(S.key),S)}}function D(v,T,b){return T&&O(v.prototype,T),b&&O(v,b),Object.defineProperty(v,"prototype",{writable:!1}),v}l.exports=D,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/get.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/superPropBase.js");function O(){return typeof Reflect<"u"&&Reflect.get?(l.exports=O=Reflect.get.bind(),l.exports.__esModule=!0,l.exports.default=l.exports):(l.exports=O=function(v,T,b){var S=c(v,T);if(S){var I=Object.getOwnPropertyDescriptor(S,T);return I.get?I.get.call(arguments.length<3?v:b):I.value}},l.exports.__esModule=!0,l.exports.default=l.exports),O.apply(this,arguments)}l.exports=O,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/getPrototypeOf.js":l=>{function r(n){return l.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(O){return O.__proto__||Object.getPrototypeOf(O)},l.exports.__esModule=!0,l.exports.default=l.exports,r(n)}l.exports=r,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/inherits.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/setPrototypeOf.js");function O(D,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(v&&v.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),Object.defineProperty(D,"prototype",{writable:!1}),v&&c(D,v)}l.exports=O,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/interopRequireDefault.js":l=>{function r(n){return n&&n.__esModule?n:{default:n}}l.exports=r,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/typeof.js").default,O=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js");function D(v,T){if(T&&(c(T)==="object"||typeof T=="function"))return T;if(T!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O(v)}l.exports=D,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/regeneratorRuntime.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/typeof.js").default;function O(){l.exports=O=function(){return v},l.exports.__esModule=!0,l.exports.default=l.exports;var D,v={},T=Object.prototype,b=T.hasOwnProperty,S=Object.defineProperty||function(i,s,d){i[s]=d.value},I=typeof Symbol=="function"?Symbol:{},B=I.iterator||"@@iterator",_=I.asyncIterator||"@@asyncIterator",J=I.toStringTag||"@@toStringTag";function H(i,s,d){return Object.defineProperty(i,s,{value:d,enumerable:!0,configurable:!0,writable:!0}),i[s]}try{H({},"")}catch{H=function(d,g,R){return d[g]=R}}function Y(i,s,d,g){var R=s&&s.prototype instanceof $?s:$,E=Object.create(R.prototype),P=new t(g||[]);return S(E,"_invoke",{value:w(i,d,P)}),E}function k(i,s,d){try{return{type:"normal",arg:i.call(s,d)}}catch(g){return{type:"throw",arg:g}}}v.wrap=Y;var m="suspendedStart",M="suspendedYield",U="executing",G="completed",N={};function $(){}function ee(){}function X(){}var A={};H(A,B,function(){return this});var te=Object.getPrototypeOf,Q=te&&te(te(f([])));Q&&Q!==T&&b.call(Q,B)&&(A=Q);var o=X.prototype=$.prototype=Object.create(A);function e(i){["next","throw","return"].forEach(function(s){H(i,s,function(d){return this._invoke(s,d)})})}function a(i,s){function d(R,E,P,W){var p=k(i[R],i,E);if(p.type!=="throw"){var L=p.arg,x=L.value;return x&&c(x)=="object"&&b.call(x,"__await")?s.resolve(x.__await).then(function(h){d("next",h,P,W)},function(h){d("throw",h,P,W)}):s.resolve(x).then(function(h){L.value=h,P(L)},function(h){return d("throw",h,P,W)})}W(p.arg)}var g;S(this,"_invoke",{value:function(E,P){function W(){return new s(function(p,L){d(E,P,p,L)})}return g=g?g.then(W,W):W()}})}function w(i,s,d){var g=m;return function(R,E){if(g===U)throw new Error("Generator is already running");if(g===G){if(R==="throw")throw E;return{value:D,done:!0}}for(d.method=R,d.arg=E;;){var P=d.delegate;if(P){var W=C(P,d);if(W){if(W===N)continue;return W}}if(d.method==="next")d.sent=d._sent=d.arg;else if(d.method==="throw"){if(g===m)throw g=G,d.arg;d.dispatchException(d.arg)}else d.method==="return"&&d.abrupt("return",d.arg);g=U;var p=k(i,s,d);if(p.type==="normal"){if(g=d.done?G:M,p.arg===N)continue;return{value:p.arg,done:d.done}}p.type==="throw"&&(g=G,d.method="throw",d.arg=p.arg)}}}function C(i,s){var d=s.method,g=i.iterator[d];if(g===D)return s.delegate=null,d==="throw"&&i.iterator.return&&(s.method="return",s.arg=D,C(i,s),s.method==="throw")||d!=="return"&&(s.method="throw",s.arg=new TypeError("The iterator does not provide a '"+d+"' method")),N;var R=k(g,i.iterator,s.arg);if(R.type==="throw")return s.method="throw",s.arg=R.arg,s.delegate=null,N;var E=R.arg;return E?E.done?(s[i.resultName]=E.value,s.next=i.nextLoc,s.method!=="return"&&(s.method="next",s.arg=D),s.delegate=null,N):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,N)}function y(i){var s={tryLoc:i[0]};1 in i&&(s.catchLoc=i[1]),2 in i&&(s.finallyLoc=i[2],s.afterLoc=i[3]),this.tryEntries.push(s)}function u(i){var s=i.completion||{};s.type="normal",delete s.arg,i.completion=s}function t(i){this.tryEntries=[{tryLoc:"root"}],i.forEach(y,this),this.reset(!0)}function f(i){if(i||i===""){var s=i[B];if(s)return s.call(i);if(typeof i.next=="function")return i;if(!isNaN(i.length)){var d=-1,g=function R(){for(;++d<i.length;)if(b.call(i,d))return R.value=i[d],R.done=!1,R;return R.value=D,R.done=!0,R};return g.next=g}}throw new TypeError(c(i)+" is not iterable")}return ee.prototype=X,S(o,"constructor",{value:X,configurable:!0}),S(X,"constructor",{value:ee,configurable:!0}),ee.displayName=H(X,J,"GeneratorFunction"),v.isGeneratorFunction=function(i){var s=typeof i=="function"&&i.constructor;return!!s&&(s===ee||(s.displayName||s.name)==="GeneratorFunction")},v.mark=function(i){return Object.setPrototypeOf?Object.setPrototypeOf(i,X):(i.__proto__=X,H(i,J,"GeneratorFunction")),i.prototype=Object.create(o),i},v.awrap=function(i){return{__await:i}},e(a.prototype),H(a.prototype,_,function(){return this}),v.AsyncIterator=a,v.async=function(i,s,d,g,R){R===void 0&&(R=Promise);var E=new a(Y(i,s,d,g),R);return v.isGeneratorFunction(s)?E:E.next().then(function(P){return P.done?P.value:E.next()})},e(o),H(o,J,"Generator"),H(o,B,function(){return this}),H(o,"toString",function(){return"[object Generator]"}),v.keys=function(i){var s=Object(i),d=[];for(var g in s)d.push(g);return d.reverse(),function R(){for(;d.length;){var E=d.pop();if(E in s)return R.value=E,R.done=!1,R}return R.done=!0,R}},v.values=f,t.prototype={constructor:t,reset:function(s){if(this.prev=0,this.next=0,this.sent=this._sent=D,this.done=!1,this.delegate=null,this.method="next",this.arg=D,this.tryEntries.forEach(u),!s)for(var d in this)d.charAt(0)==="t"&&b.call(this,d)&&!isNaN(+d.slice(1))&&(this[d]=D)},stop:function(){this.done=!0;var s=this.tryEntries[0].completion;if(s.type==="throw")throw s.arg;return this.rval},dispatchException:function(s){if(this.done)throw s;var d=this;function g(L,x){return P.type="throw",P.arg=s,d.next=L,x&&(d.method="next",d.arg=D),!!x}for(var R=this.tryEntries.length-1;R>=0;--R){var E=this.tryEntries[R],P=E.completion;if(E.tryLoc==="root")return g("end");if(E.tryLoc<=this.prev){var W=b.call(E,"catchLoc"),p=b.call(E,"finallyLoc");if(W&&p){if(this.prev<E.catchLoc)return g(E.catchLoc,!0);if(this.prev<E.finallyLoc)return g(E.finallyLoc)}else if(W){if(this.prev<E.catchLoc)return g(E.catchLoc,!0)}else{if(!p)throw new Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return g(E.finallyLoc)}}}},abrupt:function(s,d){for(var g=this.tryEntries.length-1;g>=0;--g){var R=this.tryEntries[g];if(R.tryLoc<=this.prev&&b.call(R,"finallyLoc")&&this.prev<R.finallyLoc){var E=R;break}}E&&(s==="break"||s==="continue")&&E.tryLoc<=d&&d<=E.finallyLoc&&(E=null);var P=E?E.completion:{};return P.type=s,P.arg=d,E?(this.method="next",this.next=E.finallyLoc,N):this.complete(P)},complete:function(s,d){if(s.type==="throw")throw s.arg;return s.type==="break"||s.type==="continue"?this.next=s.arg:s.type==="return"?(this.rval=this.arg=s.arg,this.method="return",this.next="end"):s.type==="normal"&&d&&(this.next=d),N},finish:function(s){for(var d=this.tryEntries.length-1;d>=0;--d){var g=this.tryEntries[d];if(g.finallyLoc===s)return this.complete(g.completion,g.afterLoc),u(g),N}},catch:function(s){for(var d=this.tryEntries.length-1;d>=0;--d){var g=this.tryEntries[d];if(g.tryLoc===s){var R=g.completion;if(R.type==="throw"){var E=R.arg;u(g)}return E}}throw new Error("illegal catch attempt")},delegateYield:function(s,d,g){return this.delegate={iterator:f(s),resultName:d,nextLoc:g},this.method==="next"&&(this.arg=D),N}},v}l.exports=O,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/setPrototypeOf.js":l=>{function r(n,c){return l.exports=r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,v){return D.__proto__=v,D},l.exports.__esModule=!0,l.exports.default=l.exports,r(n,c)}l.exports=r,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/superPropBase.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js");function O(D,v){for(;!Object.prototype.hasOwnProperty.call(D,v)&&(D=c(D),D!==null););return D}l.exports=O,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/toPrimitive.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/typeof.js").default;function O(D,v){if(c(D)!="object"||!D)return D;var T=D[Symbol.toPrimitive];if(T!==void 0){var b=T.call(D,v||"default");if(c(b)!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(v==="string"?String:Number)(D)}l.exports=O,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/toPropertyKey.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/typeof.js").default,O=n("./node_modules/@babel/runtime/helpers/toPrimitive.js");function D(v){var T=O(v,"string");return c(T)=="symbol"?T:String(T)}l.exports=D,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/helpers/typeof.js":l=>{function r(n){"@babel/helpers - typeof";return l.exports=r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},l.exports.__esModule=!0,l.exports.default=l.exports,r(n)}l.exports=r,l.exports.__esModule=!0,l.exports.default=l.exports},"./node_modules/@babel/runtime/regenerator/index.js":(l,r,n)=>{var c=n("./node_modules/@babel/runtime/helpers/regeneratorRuntime.js")();l.exports=c;try{regeneratorRuntime=c}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=c:Function("r","regeneratorRuntime = r")(c)}},"./node_modules/parse-ms/index.js":(l,r,n)=>{n.r(r),n.d(r,{default:()=>c});function c(O){if(typeof O!="number")throw new TypeError("Expected a number");const D=O>0?Math.floor:Math.ceil;return{days:D(O/864e5),hours:D(O/36e5)%24,minutes:D(O/6e4)%60,seconds:D(O/1e3)%60,milliseconds:D(O)%1e3,microseconds:D(O*1e3)%1e3,nanoseconds:D(O*1e6)%1e3}}}},De={};function K(l){var r=De[l];if(r!==void 0)return r.exports;var n=De[l]={exports:{}};return he[l].call(n.exports,n,n.exports,K),n.exports}K.d=(l,r)=>{for(var n in r)K.o(r,n)&&!K.o(l,n)&&Object.defineProperty(l,n,{enumerable:!0,get:r[n]})},K.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),K.o=(l,r)=>Object.prototype.hasOwnProperty.call(l,r),K.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})};var Oe={};return(()=>{var l=Oe;/*!**********************************!*\
  !*** ./src/js/videojs.record.js ***!
  \**********************************/var r=K("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(l,"__esModule",{value:!0}),l.Record=void 0;var n=r(K("./node_modules/@babel/runtime/helpers/typeof.js")),c=r(K("./node_modules/@babel/runtime/helpers/classCallCheck.js")),O=r(K("./node_modules/@babel/runtime/helpers/createClass.js")),D=r(K("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),v=r(K("./node_modules/@babel/runtime/helpers/get.js")),T=r(K("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),b=r(K("./node_modules/@babel/runtime/helpers/inherits.js")),S=r(K("video.js")),I=r(K("./src/js/controls/animation-display.js")),B=r(K("./src/js/controls/record-canvas.js")),_=r(K("./src/js/controls/device-button.js")),J=r(K("./src/js/controls/camera-button.js")),H=r(K("./src/js/controls/record-toggle.js")),Y=r(K("./src/js/controls/record-indicator.js")),k=r(K("./src/js/controls/picture-in-picture-toggle.js")),m=r(K("./src/js/event.js")),M=r(K("./src/js/hot-keys.js")),U=r(K("./src/js/defaults.js")),G=r(K("./src/js/utils/format-time.js")),N=r(K("./src/js/utils/browser-shim.js")),$=r(K("./src/js/utils/compare-version.js")),ee=K("./src/js/utils/detect-browser.js"),X=K("./src/js/engine/engine-loader.js"),A=K("./src/js/engine/record-mode.js");function te(C,y,u){return y=(0,T.default)(y),(0,D.default)(C,Q()?Reflect.construct(y,u||[],(0,T.default)(C).constructor):y.apply(C,u))}function Q(){try{var C=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q=function(){return!!C})()}var o=S.default.getPlugin("plugin"),e=S.default.getComponent("Player"),a="auto",w=l.Record=function(C){function y(u,t){var f;(0,c.default)(this,y),f=te(this,y,[u,t]),e.prototype.play=function(){var R=this.techGet_("play");return R!==void 0&&typeof R.then=="function"&&R.then(null,function(E){}),R},u.addClass("vjs-record"),f.loadOptions(),f.resetState(),t.formatTime&&typeof t.formatTime=="function"?f.setFormatTime(t.formatTime):f.setFormatTime(function(g,R){return(0,G.default)(g,R,f.displayMilliseconds)});var i="av-perm";switch(f.getRecordType()){case A.IMAGE_ONLY:case A.VIDEO_ONLY:case A.ANIMATION:i="video-perm";break;case A.AUDIO_ONLY:i="audio-perm";break;case A.SCREEN_ONLY:i="screen-perm";break;case A.AUDIO_SCREEN:i="sv-perm";break}_.default.prototype.buildCSSClass=function(){return"vjs-record vjs-device-button vjs-control vjs-icon-"+i},u.deviceButton=new _.default(u,t),u.addChild(u.deviceButton),u.recordIndicator=new Y.default(u,t),u.recordIndicator.hide(),u.addChild(u.recordIndicator),u.recordCanvas=new B.default(u,t),u.recordCanvas.hide(),u.addChild(u.recordCanvas),u.animationDisplay=new I.default(u,t),u.animationDisplay.hide(),u.addChild(u.animationDisplay),u.cameraButton=new J.default(u,t),u.cameraButton.hide(),u.recordToggle=new H.default(u,t),u.recordToggle.hide();var s=S.default.VERSION===void 0||(0,$.default)(S.default.VERSION,"7.6.0")===-1;if("pictureInPictureEnabled"in document||(f.pictureInPicture=!1),f.pictureInPicture===!0&&(s&&(u.pipToggle=new k.default(u,t),u.pipToggle.hide()),f.onEnterPiPHandler=f.onEnterPiP.bind(f),f.onLeavePiPHandler=f.onLeavePiP.bind(f)),f.player.options_.controlBar){var d=["deviceButton","recordIndicator","cameraButton","recordToggle"];u.pipToggle&&d.push("pipToggle"),d.forEach(function(g){f.player.options_.controlBar[g]!==void 0&&(f.player[g].layoutExclude=!0,f.player[g].hide())})}return f.player.one(m.default.READY,f.setupUI.bind(f)),f}return(0,b.default)(y,C),(0,O.default)(y,[{key:"loadOptions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f;S.default.obj!==void 0?f=S.default.obj.merge:f=S.default.mergeOptions;var i=f(U.default,this.player.options_.plugins.record,t);this.recordImage=i.image,this.recordAudio=i.audio,this.recordVideo=i.video,this.recordAnimation=i.animation,this.recordScreen=i.screen,this.maxLength=i.maxLength,this.maxFileSize=i.maxFileSize,this.displayMilliseconds=i.displayMilliseconds,this.debug=i.debug,this.pictureInPicture=i.pip,this.recordTimeSlice=i.timeSlice,this.autoMuteDevice=i.autoMuteDevice,this.pluginLibraryOptions=i.pluginLibraryOptions,this.videoFrameWidth=i.frameWidth,this.videoFrameHeight=i.frameHeight,this.videoFrameRate=i.videoFrameRate,this.videoBitRate=i.videoBitRate,this.videoEngine=i.videoEngine,this.videoRecorderType=i.videoRecorderType,this.videoMimeType=i.videoMimeType,this.videoWorkerURL=i.videoWorkerURL,this.videoWebAssemblyURL=i.videoWebAssemblyURL,this.convertEngine=i.convertEngine,this.convertAuto=i.convertAuto,this.convertWorkerURL=i.convertWorkerURL,this.convertOptions=i.convertOptions,this.audioEngine=i.audioEngine,this.audioRecorderType=i.audioRecorderType,this.audioWorkerURL=i.audioWorkerURL,this.audioWebAssemblyURL=i.audioWebAssemblyURL,this.audioBufferSize=i.audioBufferSize,this.audioSampleRate=i.audioSampleRate,this.audioBitRate=i.audioBitRate,this.audioChannels=i.audioChannels,this.audioMimeType=i.audioMimeType,this.audioBufferUpdate=i.audioBufferUpdate,this.imageOutputType=i.imageOutputType,this.imageOutputFormat=i.imageOutputFormat,this.imageOutputQuality=i.imageOutputQuality,this.animationFrameRate=i.animationFrameRate,this.animationQuality=i.animationQuality}},{key:"setupUI",value:function(){var t=this;switch(this.player.controlBar.addChild(this.player.cameraButton),this.player.controlBar.el().insertBefore(this.player.cameraButton.el(),this.player.controlBar.el().firstChild),this.player.controlBar.el().insertBefore(this.player.recordToggle.el(),this.player.controlBar.el().firstChild),this.pictureInPicture===!0?this.player.controlBar.pictureInPictureToggle===void 0&&this.player.pipToggle!==void 0?this.player.controlBar.addChild(this.player.pipToggle):this.player.controlBar.pictureInPictureToggle!==void 0&&(this.player.pipToggle=this.player.controlBar.pictureInPictureToggle,this.player.pipToggle.hide()):this.pictureInPicture===!1&&this.player.controlBar.pictureInPictureToggle!==void 0&&this.player.controlBar.pictureInPictureToggle.hide(),this.player.controlBar.remainingTimeDisplay!==void 0&&(this.player.controlBar.remainingTimeDisplay.el().style.display="none"),this.player.controlBar.liveDisplay!==void 0&&(this.player.controlBar.liveDisplay.el().style.display="none"),this.player.loop(!1),this.getRecordType()){case A.AUDIO_ONLY:this.surfer=this.player.wavesurfer(),this.surfer.setFormatTime(this._formatTime);break;case A.IMAGE_ONLY:case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.ANIMATION:case A.SCREEN_ONLY:case A.AUDIO_SCREEN:this.player.bigPlayButton!==void 0&&this.player.bigPlayButton.hide(),this.player.one(m.default.LOADEDMETADATA,function(){t.setDuration(t.maxLength)}),this.player.one(m.default.LOADSTART,function(){t.setDuration(t.maxLength)}),this.player.usingNativeControls_===!0&&this.player.tech_.el_!==void 0&&(this.player.tech_.el_.controls=!1),this.player.removeTechControlsListeners_(),this.player.options_.controls&&(this.player.controlBar.progressControl!==void 0&&this.player.controlBar.progressControl.hide(),this.player.on(m.default.USERINACTIVE,function(i){t.player.userActive(!0)}),this.player.controlBar.show(),this.player.controlBar.el().style.display="flex");break}if(this.player.off(m.default.TIMEUPDATE),this.player.off(m.default.DURATIONCHANGE),this.player.off(m.default.LOADEDMETADATA),this.player.off(m.default.LOADSTART),this.player.off(m.default.ENDED),this.setDuration(this.maxLength),this.player.options_.plugins.record&&this.player.options_.plugins.record.hotKeys&&this.player.options_.plugins.record.hotKeys!==!1){var f=this.player.options_.plugins.record.hotKeys;f===!0&&(f=M.default),this.player.options_.userActions={hotkeys:f}}this.player.controlBar.playToggle!==void 0&&this.player.controlBar.playToggle.hide()}},{key:"isRecording",value:function(){return this._recording}},{key:"isProcessing",value:function(){return this._processing}},{key:"isDestroyed",value:function(){var t=this.player===null;return t===!1&&(t=this.player.children()===null),t}},{key:"getDevice",value:function(){var t=this;if(this.deviceReadyCallback===void 0&&(this.deviceReadyCallback=this.onDeviceReady.bind(this)),this.deviceErrorCallback===void 0&&(this.deviceErrorCallback=this.onDeviceError.bind(this)),this.engineStopCallback===void 0&&(this.engineStopCallback=this.onRecordComplete.bind(this)),this.streamVisibleCallback===void 0&&(this.streamVisibleCallback=this.onStreamVisible.bind(this)),this.getRecordType()===A.SCREEN_ONLY||this.getRecordType()===A.AUDIO_SCREEN){if(navigator.mediaDevices===void 0||navigator.mediaDevices.getDisplayMedia===void 0){this.player.trigger(m.default.ERROR,"This browser does not support navigator.mediaDevices.getDisplayMedia");return}}else if(navigator.mediaDevices===void 0||navigator.mediaDevices.getUserMedia===void 0){this.player.trigger(m.default.ERROR,"This browser does not support navigator.mediaDevices.getUserMedia");return}switch(this.getRecordType()){case A.AUDIO_ONLY:this.mediaType={audio:this.audioRecorderType===a?!0:this.audioRecorderType,video:!1},this.surfer.surfer.microphone.un(m.default.DEVICE_READY,this.deviceReadyCallback),this.surfer.surfer.microphone.un(m.default.DEVICE_ERROR,this.deviceErrorCallback),this.surfer.surfer.microphone.on(m.default.DEVICE_READY,this.deviceReadyCallback),this.surfer.surfer.microphone.on(m.default.DEVICE_ERROR,this.deviceErrorCallback),this.surfer.setupPlaybackEvents(!1),this.surfer.liveMode=!0,this.surfer.surfer.microphone.paused=!1,this.surfer.surfer.backend.ac.state==="suspended"&&this.surfer.surfer.backend.ac.resume(),this.audioBufferUpdate===!0&&(this.surfer.surfer.microphone.reloadBufferFunction=function(s){t.surfer.surfer.microphone.paused||(t.surfer.surfer.empty(),t.surfer.surfer.loadDecodedBuffer(s.inputBuffer),t.player.recordedData=s.inputBuffer,t.player.trigger(m.default.AUDIO_BUFFER_UPDATE))}),this.surfer.surfer.microphone.start();break;case A.IMAGE_ONLY:case A.VIDEO_ONLY:this.getRecordType()===A.IMAGE_ONLY&&this.player.el().firstChild.addEventListener(m.default.PLAYING,this.streamVisibleCallback),this.mediaType={audio:!1,video:this.videoRecorderType===a?!0:this.videoRecorderType},navigator.mediaDevices.getUserMedia({audio:!1,video:this.getRecordType()===A.IMAGE_ONLY?this.recordImage:this.recordVideo}).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));break;case A.AUDIO_SCREEN:this.mediaType={audio:this.audioRecorderType===a?!0:this.audioRecorderType,video:this.videoRecorderType===a?!0:this.videoRecorderType};var f={};this.recordScreen===!0?f={video:!0}:(0,n.default)(this.recordScreen)==="object"&&this.recordScreen.constructor===Object&&(f=this.recordScreen),navigator.mediaDevices.getDisplayMedia(f).then(function(s){navigator.mediaDevices.getUserMedia({audio:t.recordAudio}).then(function(d){s.addTrack(d.getTracks()[0]),t.onDeviceReady.bind(t)(s)}).catch(function(d){s.active&&s.stop(),t.onDeviceError(d)})}).catch(this.onDeviceError.bind(this));break;case A.AUDIO_VIDEO:this.mediaType={audio:this.audioRecorderType===a?!0:this.audioRecorderType,video:this.videoRecorderType===a?!0:this.videoRecorderType},navigator.mediaDevices.getUserMedia({audio:this.recordAudio,video:this.recordVideo}).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));break;case A.ANIMATION:this.mediaType={audio:!1,video:!1,gif:!0},navigator.mediaDevices.getUserMedia({audio:!1,video:this.recordAnimation}).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));break;case A.SCREEN_ONLY:this.mediaType={audio:!1,video:!1,screen:!0,gif:!1};var i={};this.recordScreen===!0?i={video:!0}:(0,n.default)(this.recordScreen)==="object"&&this.recordScreen.constructor===Object&&(i=this.recordScreen),navigator.mediaDevices.getDisplayMedia(i).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));break}}},{key:"onDeviceReady",value:function(t){var f=this;if(this._deviceActive=!0,this.stream!==void 0&&this.stream.active&&this.stream.stop(),this.stream=t,this.player.deviceButton.hide(),this.setDuration(this.maxLength),this.setCurrentTime(0),this.player.controlBar.playToggle!==void 0&&this.player.controlBar.playToggle.hide(),this.off(this.player,m.default.TIMEUPDATE,this.playbackTimeUpdate),this.off(this.player,m.default.ENDED,this.playbackTimeUpdate),this.getRecordType()!==A.IMAGE_ONLY){if(this.getRecordType()!==A.AUDIO_ONLY&&(0,X.isAudioPluginActive)(this.audioEngine))throw new Error("Currently "+this.audioEngine+" is only supported in audio-only mode.");var i,s;switch(this.getRecordType()){case A.AUDIO_ONLY:i=(0,X.getAudioEngine)(this.audioEngine),s=this.audioEngine;break;default:i=(0,X.getVideoEngine)(this.videoEngine),s=this.videoEngine}try{this.engine=new i(this.player,this.player.options_)}catch{throw new Error("Could not load "+s+" plugin")}if(this.engine.on(m.default.RECORD_COMPLETE,this.engineStopCallback),this.engine.bufferSize=this.audioBufferSize,this.engine.sampleRate=this.audioSampleRate,this.engine.bitRate=this.audioBitRate,this.engine.audioChannels=this.audioChannels,this.engine.audioWorkerURL=this.audioWorkerURL,this.engine.audioWebAssemblyURL=this.audioWebAssemblyURL,this.engine.mimeType={video:this.videoMimeType,gif:"image/gif"},this.audioMimeType!==null&&this.audioMimeType!==a&&(this.engine.mimeType.audio=this.audioMimeType),this.engine.videoWorkerURL=this.videoWorkerURL,this.engine.videoWebAssemblyURL=this.videoWebAssemblyURL,this.engine.videoBitRate=this.videoBitRate,this.engine.videoFrameRate=this.videoFrameRate,this.engine.video={width:this.videoFrameWidth,height:this.videoFrameHeight},this.engine.canvas={width:this.videoFrameWidth,height:this.videoFrameHeight},this.engine.quality=this.animationQuality,this.engine.frameRate=this.animationFrameRate,this.recordTimeSlice&&this.recordTimeSlice>0&&(this.engine.timeSlice=this.recordTimeSlice,this.engine.maxFileSize=this.maxFileSize),this.engine.pluginLibraryOptions=this.pluginLibraryOptions,this.engine.setup(this.stream,this.mediaType,this.debug),this.convertEngine!==""){var d=(0,X.getConvertEngine)(this.convertEngine);try{this.converter=new d(this.player,this.player.options_)}catch{throw new Error("Could not load "+this.convertEngine+" plugin")}this.converter.convertAuto=this.convertAuto,this.converter.convertWorkerURL=this.convertWorkerURL,this.converter.convertOptions=this.convertOptions,this.converter.pluginLibraryOptions=this.pluginLibraryOptions,this.converter.setup(this.mediaType,this.debug)}var g=["currentTimeDisplay","timeDivider","durationDisplay"];g.forEach(function(R){R=f.player.controlBar[R],R!==void 0&&(R.el().style.display="block",R.show())}),this.player.recordToggle.show()}else this.player.recordIndicator.disable(),this.retrySnapshot();this.getRecordType()!==A.AUDIO_ONLY?(this.mediaElement=this.player.el().firstChild,this.mediaElement.controls=!1,this.mediaElement.muted=!0,this.displayVolumeControl(!1),this.pictureInPicture===!0&&(this.player.pipToggle.show(),this.mediaElement.removeEventListener(m.default.ENTERPICTUREINPICTURE,this.onEnterPiPHandler),this.mediaElement.removeEventListener(m.default.LEAVEPICTUREINPICTURE,this.onLeavePiPHandler),this.mediaElement.addEventListener(m.default.ENTERPICTUREINPICTURE,this.onEnterPiPHandler),this.mediaElement.addEventListener(m.default.LEAVEPICTUREINPICTURE,this.onLeavePiPHandler)),this.load(this.stream),this.player.one(m.default.LOADEDMETADATA,function(){f.mediaElement.play(),f.player.trigger(m.default.DEVICE_READY)})):this.player.trigger(m.default.DEVICE_READY)}},{key:"onDeviceError",value:function(t){this._deviceActive=!1,this.isDestroyed()||(this.player.deviceErrorCode=t,this.player.trigger(m.default.DEVICE_ERROR))}},{key:"start",value:function(){var t=this;if(!this.isProcessing()){if(this.stream&&this.stream.active===!1){this.getDevice();return}switch(this._recording=!0,this.player.controlBar.playToggle!==void 0&&this.player.controlBar.playToggle.hide(),this.off(this.player,m.default.TIMEUPDATE,this.playbackTimeUpdate),this.off(this.player,m.default.ENDED,this.playbackTimeUpdate),this.getRecordType()){case A.AUDIO_ONLY:this.surfer.setupPlaybackEvents(!1),this.surfer.surfer.microphone.paused=!1,this.surfer.liveMode=!0,this.surfer.surfer.microphone.play();break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.AUDIO_SCREEN:case A.SCREEN_ONLY:this.startVideoPreview();break;case A.ANIMATION:this.player.recordCanvas.hide(),this.player.animationDisplay.hide(),this.mediaElement.style.display="block",this.captureFrame().then(function(f){t.startVideoPreview()});break}switch(this.autoMuteDevice&&this.muteTracks(!1),this.getRecordType()){case A.IMAGE_ONLY:this.createSnapshot(),this.player.trigger(m.default.START_RECORD);break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.AUDIO_SCREEN:case A.ANIMATION:case A.SCREEN_ONLY:this.player.one(m.default.LOADEDMETADATA,function(){t.startRecording()});break;default:this.startRecording()}}}},{key:"startRecording",value:function(){this.paused=!1,this.pauseTime=this.pausedTime=0,this.startTime=performance.now();var t=100;this.countDown=this.player.setInterval(this.onCountDown.bind(this),t),this.engine!==void 0&&this.engine.dispose(),this.engine.start(),this.player.trigger(m.default.START_RECORD)}},{key:"stop",value:function(){this.isProcessing()||(this._recording=!1,this._processing=!0,this.getRecordType()!==A.IMAGE_ONLY?(this.player.trigger(m.default.STOP_RECORD),this.player.clearInterval(this.countDown),this.engine&&this.engine.stop(),this.autoMuteDevice&&this.muteTracks(!0)):this.player.recordedData&&this.player.trigger(m.default.FINISH_RECORD))}},{key:"stopDevice",value:function(){this.isRecording()?(this.player.one(m.default.FINISH_RECORD,this.stopStream.bind(this)),this.stop()):this.stopStream()}},{key:"stopStream",value:function(){if(this.stream){if(this._deviceActive=!1,this.getRecordType()===A.AUDIO_ONLY){this.surfer.surfer.microphone.stopDevice();return}this.stream.getTracks().forEach(function(t){t.stop()})}}},{key:"pause",value:function(){this.paused||(this.pauseTime=performance.now(),this.paused=!0,this.engine.pause())}},{key:"resume",value:function(){this.paused&&(this.pausedTime+=performance.now()-this.pauseTime,this.engine.resume(),this.paused=!1)}},{key:"onRecordComplete",value:function(){var t=this;if(this.player.recordedData=this.engine.recordedData,this.player.controlBar.playToggle!==void 0&&(this.player.controlBar.playToggle.removeClass("vjs-ended"),this.player.controlBar.playToggle.show()),this.convertAuto===!0&&this.convert(),this.player.trigger(m.default.FINISH_RECORD),!this.isDestroyed())switch(this.getRecordType()){case A.AUDIO_ONLY:this.surfer.pause(),this.surfer.setupPlaybackEvents(!0),this.player.loadingSpinner.show(),this.surfer.surfer.once(m.default.READY,function(){t._processing=!1}),this.load(this.player.recordedData);break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.AUDIO_SCREEN:case A.SCREEN_ONLY:this.player.one(m.default.PAUSE,function(){t._processing=!1,t.player.loadingSpinner.hide(),t.setDuration(t.streamDuration),t.on(t.player,m.default.TIMEUPDATE,t.playbackTimeUpdate),t.on(t.player,m.default.ENDED,t.playbackTimeUpdate),(t.getRecordType()===A.AUDIO_VIDEO||t.getRecordType()===A.AUDIO_SCREEN)&&(t.mediaElement.muted=!1,t.displayVolumeControl(!0)),t.load(t.player.recordedData)}),this.player.pause();break;case A.ANIMATION:this._processing=!1,this.player.loadingSpinner.hide(),this.setDuration(this.streamDuration),this.mediaElement.style.display="none",this.player.recordCanvas.show(),this.player.pause(),this.on(this.player,m.default.PLAY,this.showAnimation),this.on(this.player,m.default.PAUSE,this.hideAnimation);break}}},{key:"onCountDown",value:function(){if(!this.paused){var t=performance.now(),f=this.maxLength,i=(t-(this.startTime+this.pausedTime))/1e3;this.streamDuration=i,i>=f&&(i=f,this.stop()),this.setDuration(f),this.setCurrentTime(i,f),this.player.trigger(m.default.PROGRESS_RECORD)}}},{key:"getCurrentTime",value:function(){var t=isNaN(this.streamCurrentTime)?0:this.streamCurrentTime;return this.getRecordType()===A.AUDIO_ONLY&&(t=this.surfer.getCurrentTime()),t}},{key:"setCurrentTime",value:function(t,f){switch(t=isNaN(t)?0:t,f=isNaN(f)?0:f,this.getRecordType()){case A.AUDIO_ONLY:this.surfer.setCurrentTime(t,f);break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.AUDIO_SCREEN:case A.ANIMATION:case A.SCREEN_ONLY:this.player.controlBar.currentTimeDisplay&&this.player.controlBar.currentTimeDisplay.contentEl()&&this.player.controlBar.currentTimeDisplay.contentEl().lastChild&&(this.streamCurrentTime=Math.min(t,f),this.player.controlBar.currentTimeDisplay.formattedTime_=this.player.controlBar.currentTimeDisplay.contentEl().lastChild.textContent=this._formatTime(this.streamCurrentTime,f,this.displayMilliseconds));break}}},{key:"getDuration",value:function(){var t=isNaN(this.streamDuration)?0:this.streamDuration;return t}},{key:"setDuration",value:function(t){switch(t=isNaN(t)?0:t,this.getRecordType()){case A.AUDIO_ONLY:this.surfer.setDuration(t);break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.AUDIO_SCREEN:case A.ANIMATION:case A.SCREEN_ONLY:this.player.controlBar.durationDisplay&&this.player.controlBar.durationDisplay.contentEl()&&this.player.controlBar.durationDisplay.contentEl().lastChild&&(this.player.controlBar.durationDisplay.formattedTime_=this.player.controlBar.durationDisplay.contentEl().lastChild.textContent=this._formatTime(t,t,this.displayMilliseconds));break}}},{key:"load",value:function(t){switch(this.getRecordType()){case A.AUDIO_ONLY:this.surfer.load(t);break;case A.IMAGE_ONLY:case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.AUDIO_SCREEN:case A.ANIMATION:case A.SCREEN_ONLY:t instanceof Blob||t instanceof File?(this.mediaElement.srcObject=null,this.mediaElement.src=URL.createObjectURL(t)):(0,N.default)(t,this.mediaElement);break}}},{key:"saveAs",value:function(t){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"record";f==="record"?this.engine&&t!==void 0&&this.engine.saveAs(t):f==="convert"&&this.converter&&t!==void 0&&this.converter.saveAs(t)}},{key:"dispose",value:function(){this.player.off(m.default.READY),this.player.off(m.default.USERINACTIVE),this.player.off(m.default.LOADEDMETADATA),this.engine&&(this.engine.dispose(),this.engine.destroy(),this.engine.off(m.default.RECORD_COMPLETE,this.engineStopCallback)),this.stop(),this.stopDevice(),this.removeRecording(),this.player.clearInterval(this.countDown),this.getRecordType()===A.AUDIO_ONLY?this.surfer&&this.surfer.destroy():this.getRecordType()===A.IMAGE_ONLY&&this.mediaElement&&this.streamVisibleCallback&&this.mediaElement.removeEventListener(m.default.PLAYING,this.streamVisibleCallback),this.resetState(),(0,v.default)((0,T.default)(y.prototype),"dispose",this).call(this)}},{key:"destroy",value:function(){this.player.dispose()}},{key:"reset",value:function(){var t=this;switch(this.engine&&(this.engine.dispose(),this.engine.off(m.default.RECORD_COMPLETE,this.engineStopCallback)),this.stop(),this.stopDevice(),this.player.clearInterval(this.countDown),this.removeRecording(),this.loadOptions(),this.resetState(),this.setDuration(this.maxLength),this.setCurrentTime(0),this.player.reset(),this.getRecordType()){case A.AUDIO_ONLY:this.surfer&&this.surfer.surfer&&this.surfer.surfer.empty();break;case A.IMAGE_ONLY:case A.ANIMATION:this.player.recordCanvas.hide(),this.player.cameraButton.hide();break}this.player.controlBar.playToggle!==void 0&&this.player.controlBar.playToggle.hide(),this.player.deviceButton.show(),this.player.recordToggle.hide(),this.player.one(m.default.LOADEDMETADATA,function(){t.setDuration(t.maxLength)})}},{key:"resetState",value:function(){this._recording=!1,this._processing=!1,this._deviceActive=!1,this.devices=[]}},{key:"removeRecording",value:function(){this.mediaElement&&this.mediaElement.src&&this.mediaElement.src.startsWith("blob:")===!0&&(URL.revokeObjectURL(this.mediaElement.src),this.mediaElement.src="")}},{key:"exportImage",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(this.getRecordType()===A.AUDIO_ONLY)return this.surfer.surfer.exportImage(t,f,"blob");var i=this.player.recordCanvas.el().firstChild;return this.drawCanvas(i,this.mediaElement),new Promise(function(s){i.toBlob(s,t,f)})}},{key:"muteTracks",value:function(t){(this.getRecordType()===A.AUDIO_ONLY||this.getRecordType()===A.AUDIO_SCREEN||this.getRecordType()===A.AUDIO_VIDEO)&&this.stream.getAudioTracks().length>0&&(this.stream.getAudioTracks()[0].enabled=!t),this.getRecordType()!==A.AUDIO_ONLY&&this.stream.getVideoTracks().length>0&&(this.stream.getVideoTracks()[0].enabled=!t)}},{key:"getRecordType",value:function(){return(0,A.getRecorderMode)(this.recordImage,this.recordAudio,this.recordVideo,this.recordAnimation,this.recordScreen)}},{key:"convert",value:function(){this.converter!==void 0&&this.converter.convert(this.player.recordedData)}},{key:"createSnapshot",value:function(){var t=this;this.captureFrame().then(function(f){t.imageOutputType==="blob"?f.toBlob(function(i){t.player.recordedData=i,t.displaySnapshot()}):t.imageOutputType==="dataURL"&&(t.player.recordedData=f.toDataURL(t.imageOutputFormat,t.imageOutputQuality),t.displaySnapshot())},this.imageOutputFormat,this.imageOutputQuality)}},{key:"displaySnapshot",value:function(){this.mediaElement.style.display="none",this.player.recordCanvas.show(),this.stop()}},{key:"retrySnapshot",value:function(){this._processing=!1,this.player.recordCanvas.hide(),this.player.el().firstChild.style.display="block"}},{key:"captureFrame",value:function(){var t=this,f=(0,ee.detectBrowser)(),i=this.player.recordCanvas.el().firstChild,s=this.stream.getVideoTracks()[0],d=s.getSettings();return i.width=d.width,i.height=d.height,new Promise(function(g,R){var E=d.width/d.height,P=t.player.width()/t.player.height(),W=0,p=0,L=0,x=0;if(E>=P?(W=d.height*(t.player.width()/d.width),p=t.player.width(),x=t.player.height()/2-W/2):(W=t.player.height(),p=d.width*(t.player.height()/d.height),L=t.player.width()/2-p/2),f.browser==="chrome"&&f.version>=60&&(typeof ImageCapture>"u"?"undefined":(0,n.default)(ImageCapture))===(typeof Function>"u"?"undefined":(0,n.default)(Function)))try{var h=new ImageCapture(s);h.grabFrame().then(function(j){t.drawCanvas(i,j,p,W,L,x),g(i)}).catch(function(j){})}catch{}t.drawCanvas(i,t.mediaElement,p,W,L,x),g(i)})}},{key:"drawCanvas",value:function(t,f,i,s){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;i===void 0&&(i=t.width),s===void 0&&(s=t.height),t.getContext("2d").drawImage(f,d,g,i,s)}},{key:"startVideoPreview",value:function(){this.off(m.default.TIMEUPDATE),this.off(m.default.DURATIONCHANGE),this.off(m.default.LOADEDMETADATA),this.off(m.default.PLAY),this.mediaElement.muted=!0,this.displayVolumeControl(!1),this.removeRecording(),this.load(this.stream),this.mediaElement.play()}},{key:"showAnimation",value:function(){var t=this.player.animationDisplay.el().firstChild;t.width=this.player.width(),t.height=this.player.height(),this.player.recordCanvas.hide(),(0,N.default)(this.player.recordedData,t),this.player.animationDisplay.show()}},{key:"hideAnimation",value:function(){this.player.recordCanvas.show(),this.player.animationDisplay.hide()}},{key:"playbackTimeUpdate",value:function(){this.setCurrentTime(this.player.currentTime(),this.streamDuration)}},{key:"enumerateDevices",value:function(){var t=this;if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices){this.player.enumerateErrorCode="enumerateDevices() not supported.",this.player.trigger(m.default.ENUMERATE_ERROR);return}navigator.mediaDevices.enumerateDevices(this).then(function(f){t.devices=[],f.forEach(function(i){t.devices.push(i)}),t.player.trigger(m.default.ENUMERATE_READY)}).catch(function(f){t.player.enumerateErrorCode=f,t.player.trigger(m.default.ENUMERATE_ERROR)})}},{key:"setVideoInput",value:function(t){this.recordVideo===Object(this.recordVideo)?this.recordVideo.deviceId={exact:t}:this.recordVideo===!0&&(this.recordVideo={deviceId:{exact:t}}),this.stopDevice(),this.getDevice()}},{key:"setAudioInput",value:function(t){switch(this.recordAudio===Object(this.recordAudio)?this.recordAudio.deviceId={exact:t}:this.recordAudio===!0&&(this.recordAudio={deviceId:{exact:t}}),this.getRecordType()){case A.AUDIO_ONLY:this.surfer.surfer.microphone.constraints={video:!1,audio:this.recordAudio};break}this.stopDevice(),this.getDevice()}},{key:"setAudioOutput",value:function(t){var f=this,i;switch(this.getRecordType()){case A.AUDIO_ONLY:this.surfer.surfer.setSinkId(t).then(function(d){f.player.trigger(m.default.AUDIO_OUTPUT_READY)}).catch(function(d){i=d});break;default:var s=player.tech_.el_;t?typeof s.sinkId<"u"?s.setSinkId(t).then(function(d){f.player.trigger(m.default.AUDIO_OUTPUT_READY)}).catch(function(d){i=d}):i="Browser does not support audio output device selection.":i="Invalid deviceId: ".concat(t);break}this.player.trigger(m.default.ERROR,i)}},{key:"setFormatTime",value:function(t){this._formatTime=t,S.default.time!==void 0?S.default.time.setFormatTime(this._formatTime):S.default.setFormatTime(this._formatTime),this.surfer&&this.surfer.setFormatTime(this._formatTime)}},{key:"displayVolumeControl",value:function(t){this.player.controlBar.volumePanel!==void 0&&(t===!0?t="flex":t="none",this.player.controlBar.volumePanel.el().style.display=t)}},{key:"onStreamVisible",value:function(t){this.mediaElement.removeEventListener(m.default.PLAYING,this.streamVisibleCallback),this.player.cameraButton.onStop(),this.player.cameraButton.show()}},{key:"onEnterPiP",value:function(t){this.player.trigger(m.default.ENTER_PIP,t)}},{key:"onLeavePiP",value:function(t){this.player.trigger(m.default.LEAVE_PIP)}}])}(o);w.VERSION="4.8.0",S.default.Record=w,S.default.getPlugin("record")===void 0&&S.default.registerPlugin("record",w)})(),Oe})())}(Ne)),Ne.exports}var rt=tt();const it=We(rt);function at({onSubmit:Te=null}={}){return{player:null,isRecording:!1,hasRecording:!1,isUploading:!1,uploadProgress:0,submitCallback:Te,recordedBlob:null,videoElement:null,initialized:!1,recordPlugin:it,rtcPlugin:et,currentTime:0,timer:null,deviceReady:!1,init(){this.initialized=!0,this.$nextTick(()=>{this.videoElement=this.$refs.videoRecorder,console.log(this.videoElement),this.videoElement&&this.setupVideoJS()})},setupVideoJS(){if(!this.videoElement){console.error("Video element not found");return}const ge={controls:!1,bigPlayButton:!1,fluid:!0,responsive:!0,aspectRatio:window.innerWidth<=768?"9:16":"16:9",plugins:{record:{image:!1,audio:!1,video:!0,maxLength:30,videoMimeType:"video/webm;codecs=vp8",displayMilliseconds:!0,debug:!1}}};this.player=ke("video-recorder",ge,()=>{console.log("VideoJS Record player ready"),console.log("Using video.js",ke.VERSION),ke.getPluginVersion&&console.log("with videojs-record",ke.getPluginVersion("record"))}),this.player.on("deviceReady",()=>{console.log("Device ready"),this.deviceReady=!0}),this.player.on("startRecord",()=>{console.log("Recording started"),this.isRecording=!0,this.hasRecording=!1,this.currentTime=0,this.startTimer()}),this.player.on("stopRecord",()=>{console.log("Recording stopped"),this.stopTimer()}),this.player.on("finishRecord",()=>{console.log("Recording finished"),this.isRecording=!1,this.hasRecording=!0,this.recordedBlob=this.player.recordedData,this.stopTimer(),console.log(this.recordedBlob.type),console.log(URL.createObjectURL(this.recordedBlob)),this.player.src({type:"video/webm",src:URL.createObjectURL(this.recordedBlob)}),this.player.controls(!0),this.player.ready(()=>{this.player.play()})}),this.player.on("error",he=>{console.error("VideoJS Error:",he)}),this.player.on("deviceError",()=>{console.error("Device error:",this.player.deviceErrorCode)});const ye=this.player.el();ye&&["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","click"].forEach(he=>{ye.addEventListener(he,De=>{De.stopPropagation()})})},startRecording(){this.player&&this.player.record&&!this.isRecording&&this.player.record().start()},stopRecording(){this.player&&this.player.record&&this.isRecording&&this.player.record().stop()},getRecordingTime(){return this.player&&this.player.record&&this.player.record().getCurrentTime()||0},formatTime(F){const ge=Math.floor(F/60),ye=Math.floor(F%60).toString().padStart(2,"0");return`${ge}:${ye}`},startTimer(){this.currentTime=0,this.timer=setInterval(()=>{this.currentTime++},1e3)},stopTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)},async submitRecording(){if(!(!this.recordedBlob||this.isUploading)){this.isUploading=!0,this.uploadProgress=0;try{if(typeof this.submitCallback=="function"){const F=await this.submitCallback(this.recordedBlob);return this.uploadProgress=100,setTimeout(()=>{this.isUploading=!1,this.uploadProgress=0,this.resetRecording()},500),F}else console.warn("No submit callback provided"),this.isUploading=!1}catch(F){console.error("Submit error:",F),this.isUploading=!1,this.uploadProgress=0,this.$dispatch("video-upload-error",{error:F.message})}}},resetRecording(){this.player&&this.player.record().reset(),this.hasRecording=!1,this.isRecording=!1,this.recordedBlob=null,this.currentTime=0,this.stopTimer()},destroy(){this.stopTimer(),this.player&&(this.player.dispose(),this.player=null)}}}export{at as default};
